{"version":3,"file":"FormHandler.js.map","sources":["../../src/js/common/FormHandlerError.js","../../src/js/core/Validator.js","../../src/js/common/constants.js","../../src/js/core/Form.js","../../src/js/core/Field.js","../../src/js/core/Input.js","../../src/js/core/Radio.js","../../src/js/core/Select.js","../../src/js/core/Color.js","../../src/js/core/Notice.js","../../src/js/core/Sender.js","../../src/js/common/defaultConfig.js","../../src/js/core/FormHandlerUtil.js","../../src/js/FormHandler.js"],"sourcesContent":["/* eslint-disable no-useless-constructor */\nexport default class FormHandlerError extends Error {\n  constructor(props) {\n    super(props);\n  }\n}\n","/* eslint-disable no-useless-escape */\nimport FormHandlerError from '../common/FormHandlerError';\n\nexport default class Validator {\n  constructor(custom) {\n    this.custom = custom;\n\n    this.addCustomValidations();\n  }\n\n  addCustomValidations() {\n    Object.entries(this.custom).forEach(([type, obj]) => {\n      Validator.validations[type] = obj;\n    });\n    return this;\n  }\n\n  static validate({\n    type, node, min, max,\n  }) {\n    if (!type) return;\n    const validation = Validator.validations[type];\n\n    if (!validation) {\n      throw new FormHandlerError(`No handler to validate type ${type}`);\n    }\n\n    // eslint-disable-next-line consistent-return\n    return validation(node, min, max);\n  }\n\n  static validations = {\n    isCheckboxChecked(node, min, max) {\n      const message = 'Check any boxes';\n      let valid = false;\n      let checked = 0;\n\n      node.forEach((el) => {\n        if (el.checked) checked += 1;\n      });\n\n      if (min && max) {\n        valid = !!(min && max && checked >= min && checked <= max);\n      }\n      if (min && !max) {\n        valid = checked >= min;\n      }\n      if (!min && max) {\n        valid = checked <= max;\n      }\n\n      return {\n        valid,\n        message,\n      };\n    },\n    isRadioChecked(node) {\n      const valid = Array.from(node).some(el => el.checked === true);\n\n\n      const message = 'Please, press any button';\n\n      return {\n        valid,\n        message,\n      };\n    },\n    isSelected(node) {\n      const valid = Array.from(node.options)\n        .filter(el => el.value.length > 0)\n        .some(el => el.selected === true);\n\n\n      const message = 'Please, choose any option';\n      return {\n        valid,\n        message,\n      };\n    },\n    isName(node, min, max) {\n      const pattern = /^[A-Za-z]/;\n      let valid = pattern.test(node.value);\n      let message = 'Must contain any latin character';\n\n      if (node.value.length === 0) {\n        valid = false;\n        if (min && !max) {\n          message = `Must contain at least ${min} latin character`;\n        }\n        if (!min && max) {\n          message = `Must contain at least one latin character and less than ${max + 1}`;\n        }\n        if (min && max) {\n          message = `Must contain between ${min} and ${max} latin characters`;\n        }\n      } else {\n        if (min && node.value.length < min) {\n          valid = false;\n          message = `Must contain at least ${min} latin characters`;\n        }\n\n        if (min && node.value.length > min) {\n          valid = true;\n        }\n        if (max && node.value.length > max) {\n          valid = false;\n          message = `Must contain less than ${max + 1} latin characters`;\n        }\n      }\n      console.log(message)\n\n\n      return {\n        valid,\n        message,\n      };\n    },\n    isEmail(node) {\n      const pattern = /^(([^<>()\\[\\]\\.,;:\\s@\\\"]+(\\.[^<>()\\[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()[\\]\\.,;:\\s@\\\"]{2,})$/i;\n      const valid = pattern.test(node.value);\n\n\n      const message = 'Must be a valid email address';\n\n      return {\n        valid,\n        message,\n      };\n    },\n    isPhone(node) {\n      const pattern = /^[+]?[\\s./0-9]*[(]?[0-9]{1,4}[)]?[-\\s./0-9]*$/g;\n      const valid = pattern.test(node.value);\n      const message = 'Must contain a valid phone number';\n\n      return {\n        valid,\n        message,\n      };\n    },\n    isNonEmpty(node, min, max) {\n      let valid = node.value.length > 0;\n\n\n      const message = 'Must be non empty';\n\n      if (min && node.value.length < min && node.value.length !== 0) {\n        valid = false;\n      }\n      if (max && node.value.length > max && node.value.length !== 0) {\n        valid = false;\n      }\n\n      return {\n        valid,\n        message,\n      };\n    },\n  };\n}\n","export const HTML_SELECT_ELEMENT = 'HTMLSelectElement';\nexport const INPUT = 'input';\nexport const LOAD = 'load';\nexport const UNDEFINED = 'undefined';\nexport const SUCCESS = 'success';\nexport const ERROR = 'error';\nexport const OBJECT = 'object';\nexport const FORM = 'form';\nexport const CLICK = 'click';\nexport const DIV = 'div';\nexport const READY_STATE_CHANGE = 'readystatechange';\nexport const XHR = 'xhr';\nexport const FETCH = 'fetch';\nexport const AFTER = 'after';\nexport const BEFORE = 'before';\nexport const STRING = 'string';\nexport const CHECKBOX = 'checkbox';\nexport const RADIO = 'radio';\nexport const SELECT = 'select-one';\nexport const NODE_LIST = 'NodeList';\nexport const COLOR = 'color';\n","import {\n  CLICK,\n} from '../common/constants';\n\nexport default class Form {\n  constructor({ ...opts }) {\n    this.node = opts.node;\n    this.submit = opts.submit;\n    this.classNames = opts.classNames;\n    this.fields = opts.fields;\n    this.listener = opts.listener;\n    this.valid = false;\n    this.submitted = false;\n    this.sended = null;\n    this.callback = opts.callback;\n\n    this.submit.addEventListener(CLICK, this.listener);\n  }\n\n  get fieldsValidity() {\n    const validness = new Set();\n\n    // eslint-disable-next-line no-unused-vars\n    Object.entries(this.fields).forEach(([name, field]) => {\n      if (field.validation) {\n        validness.add(field.valid);\n      }\n    });\n\n    return !validness.has(false);\n  }\n\n  setFormState() {\n    const validity = this.fieldsValidity;\n    console.log(validity)\n\n    this.callback(this.node, this.valid, validity);\n\n    this.valid = validity;\n\n    if (this.submitted) {\n      this.toggleClassNames();\n    }\n  }\n\n  toggleClassNames() {\n    if (this.valid) {\n      this.node.classList.remove(this.classNames.isNotValid);\n      this.node.classList.add(this.classNames.isValid);\n    } else {\n      this.node.classList.remove(this.classNames.isValid);\n      this.node.classList.add(this.classNames.isNotValid);\n    }\n  }\n\n  clear() {\n    // eslint-disable-next-line no-unused-vars\n    Object.entries(this.fields).forEach(([name, field]) => {\n      field.clear();\n    });\n\n    this.callback(this.node, this.valid, false);\n    this.valid = false;\n    this.node.classList.remove(this.classNames.isNotValid);\n    this.node.classList.remove(this.classNames.isValid);\n  }\n}\n","import {\n  NODE_LIST,\n} from '../common/constants';\n\nexport default class Field {\n  constructor({\n    node, validation, min, max, send, classNames, callback,\n  }) {\n    this.node = node;\n    this.type = this.node.constructor.name;\n    this.name = this.type === NODE_LIST ? this.node[0].name : this.node.name;\n    this.validation = validation;\n    this.send = send;\n    this.min = min;\n    this.max = max;\n    this.classNames = classNames;\n    this.valid = false;\n    this.submitted = false;\n    this.callback = callback;\n  }\n\n  get validatorOptions() {\n    return {\n      type: this.validation,\n      node: this.node,\n      min: this.min,\n      max: this.max,\n    };\n  }\n\n  setFieldSubmitted(value) {\n    this.submitted = value;\n  }\n\n  on(type, listener) {\n    if (this.type === NODE_LIST) {\n      this.node.forEach(el => el.addEventListener(type, listener));\n    } else {\n      this.node.addEventListener(type, listener);\n    }\n  }\n\n  off(type, listener) {\n    if (this.type === NODE_LIST) {\n      this.node.forEach(el => el.removeEventListener(type, listener));\n    } else {\n      this.node.removeEventListener(type, listener);\n    }\n  }\n\n  remove() {\n    this.node.remove();\n  }\n}\n","import Field from './Field';\n\nexport default class Input extends Field {\n  constructor({ ...opts }) {\n    super({ ...opts });\n  }\n\n  setFieldState(valid) {\n    this.callback(this.name, this.node, this.valid, valid);\n\n    this.valid = valid;\n\n    if (this.submitted) {\n      this.toggleClassNames();\n    }\n  }\n\n  toggleClassNames() {\n    if (this.valid) {\n      this.node.classList.remove(this.classNames.isNotValid);\n      this.node.classList.add(this.classNames.isValid);\n    } else {\n      this.node.classList.remove(this.classNames.isValid);\n      this.node.classList.add(this.classNames.isNotValid);\n    }\n  }\n\n  clear() {\n    this.callback(this.name, this.node, this.valid, false);\n    this.node.value = '';\n    this.valid = false;\n    this.submitted = false;\n    this.node.classList.remove(this.classNames.isNotValid);\n    this.node.classList.remove(this.classNames.isValid);\n  }\n}\n","import Field from './Field';\n\nexport default class Radio extends Field {\n  constructor({ ...opts }) {\n    super({ ...opts });\n  }\n\n  setFieldState(valid) {\n    this.callback(this.name, this.node, this.valid, valid);\n\n    this.valid = valid;\n\n    if (this.submitted) {\n      this.toggleClassNames();\n    }\n  }\n\n  toggleClassNames() {\n    if (this.valid) {\n      this.node.forEach(el => el.classList.remove(this.classNames.isNotValid));\n      this.node.forEach(el => el.classList.add(this.classNames.isValid));\n    } else {\n      this.node.forEach(el => el.classList.remove(this.classNames.isValid));\n      this.node.forEach(el => el.classList.add(this.classNames.isNotValid));\n    }\n  }\n\n  clear() {\n    this.callback(this.name, this.node, this.valid, false);\n    this.valid = false;\n    this.submitted = false;\n    this.node.forEach(el => el.classList.remove(this.classNames.isValid));\n    this.node.forEach(el => el.classList.remove(this.classNames.isNotValid));\n    this.node.forEach((el) => {\n      // eslint-disable-next-line no-param-reassign\n      el.checked = false;\n    });\n  }\n}\n","import Field from './Field';\n\nexport default class Select extends Field {\n  constructor({ ...opts }) {\n    super({ ...opts });\n  }\n\n  setFieldState(valid) {\n    this.callback(this.name, this.node, this.valid, valid);\n\n    this.valid = valid;\n\n    if (this.submitted) {\n      this.toggleClassNames();\n    }\n  }\n\n  toggleClassNames() {\n    if (this.valid) {\n      this.node.classList.remove(this.classNames.isNotValid);\n      this.node.classList.add(this.classNames.isValid);\n    } else {\n      this.node.classList.remove(this.classNames.isValid);\n      this.node.classList.add(this.classNames.isNotValid);\n    }\n  }\n\n  clear() {\n    this.callback(this.name, this.node, this.valid, false);\n    this.valid = false;\n    this.submitted = false;\n    this.node.classList.remove(this.classNames.isValid);\n    this.node.classList.remove(this.classNames.isNotValid);\n    Array.from(this.node.options).forEach((el) => {\n      el.selected = false;\n    });\n  }\n}\n","import Field from './Field';\n\nexport default class Color extends Field {\n  constructor({ ...opts }) {\n    super({ ...opts });\n  }\n\n  setFieldState(valid) {\n    this.callback(this.name, this.node, this.valid, valid);\n\n    this.valid = valid;\n\n    if (this.submitted) {\n      this.toggleClassNames();\n    }\n  }\n\n  toggleClassNames() {\n    if (this.valid) {\n      this.node.classList.remove(this.classNames.isNotValid);\n      this.node.classList.add(this.classNames.isValid);\n    } else {\n      this.node.classList.remove(this.classNames.isValid);\n      this.node.classList.add(this.classNames.isNotValid);\n    }\n  }\n\n  clear() {\n    this.callback(this.name, this.node, this.valid, false);\n    this.node.value = '#000000';\n    this.valid = false;\n    this.submitted = false;\n    this.node.classList.remove(this.classNames.isNotValid);\n    this.node.classList.remove(this.classNames.isValid);\n  }\n}\n","import {\n  DIV,\n  BEFORE,\n  AFTER,\n} from '../common/constants';\n\nexport default class Notice {\n  constructor({\n    form, message, classNames, attachTo, nextToField, parent,\n  }) {\n    this.form = form;\n    this.message = message;\n    this.classNames = classNames;\n    this.attachTo = attachTo;\n    this.nextToField = nextToField;\n    this.parent = parent;\n    this.node = null;\n    this.mount();\n  }\n\n  mount() {\n    this.node = document.createElement(DIV);\n    this.node.classList.add(this.classNames.block);\n    this.node.classList.add(this.classNames.hidden);\n\n    if (this.attachTo) {\n      this.parent.appendChild(this.node);\n    } else {\n      if (this.nextToField === BEFORE) {\n        this.form.insertBefore(this.node, this.parent);\n      }\n      if (this.nextToField === AFTER) {\n        this.form.insertBefore(this.node, this.parent.nextElementSibling);\n      }\n    }\n  }\n\n  show() {\n    this.node.classList.remove(this.classNames.hidden);\n    this.node.classList.add(this.classNames.visible);\n    this.node.innerText = this.message;\n  }\n\n  hide() {\n    this.node.classList.remove(this.classNames.visible);\n    this.node.classList.add(this.classNames.hidden);\n  }\n\n  remove() {\n    this.node.remove();\n  }\n}\n","import FormHandlerError from '../common/FormHandlerError';\nimport {\n  HTML_SELECT_ELEMENT,\n  READY_STATE_CHANGE,\n  FETCH,\n  XHR,\n  SUCCESS,\n  ERROR,\n  NODE_LIST,\n} from '../common/constants';\n\nexport default class Sender {\n  constructor({\n    type, url, method, fields, form, callbacks,\n  }) {\n    this.type = type;\n    this.url = url;\n    this.method = method;\n    this.fields = fields;\n    this.form = form;\n    this.callbacks = callbacks;\n  }\n\n  makeData() {\n    const data = new FormData();\n\n    // eslint-disable-next-line no-unused-vars\n    Object.entries(this.fields).forEach(([name, field]) => {\n      if (!field.send) return;\n      const type = field.node.constructor.name;\n\n      if (type === NODE_LIST) { // Radio/Checkbox\n        Array.from(field.node).forEach((node) => {\n          if (node.checked) {\n            data.append(field.name, node.value);\n          }\n        });\n      } else if (type === HTML_SELECT_ELEMENT) {\n        data.append(field.name, field.node.options[field.node.options.selectedIndex].value);\n      } else { // Others\n        data.append(field.name, field.node.value);\n      }\n    });\n\n    return data;\n  }\n\n  sendRequest(data) {\n    if (this.type === XHR) {\n      const xhr = new XMLHttpRequest();\n      xhr.open(this.method, this.url, true);\n      xhr.addEventListener(READY_STATE_CHANGE, (ev) => {\n        if (ev.target.readyState === 4) {\n          if (ev.target.status >= 200 && ev.target.status < 400) {\n            this.callbacks.setFormState(SUCCESS);\n            this.callbacks.onSend(SUCCESS);\n          } else {\n            this.callbacks.setFormState(ERROR);\n            this.callbacks.onSend(ERROR);\n            throw new FormHandlerError(`Status: ${ev.target.status}, Text: ${ev.target.statusText}`);\n          }\n        }\n      });\n      xhr.send(data);\n    }\n\n    if (this.type === FETCH) {\n      fetch(this.url, {\n        method: this.method,\n        body: data,\n      }).then((response) => {\n        if (response.status >= 200 && response.status < 400) {\n          this.callbacks.setFormState(SUCCESS);\n          this.callbacks.onSend(SUCCESS);\n        } else {\n          this.callbacks.setFormState(ERROR);\n          this.callbacks.onSend(ERROR);\n          throw new FormHandlerError(`Status: ${response.status}, Text: ${response.statusText}`);\n        }\n      });\n    }\n  }\n}\n","export default {\n  form: {\n    block: '.formhandler',\n    submit: '.formhandler__submit',\n    notice: {\n      attachTo: '.formhandler__notices',\n      message: 'please, fill the form',\n      successMessage: 'ok',\n      errorMessage: 'oops',\n      classNames: {\n        block: 'formhandler__notice-form',\n        hidden: 'formhandler__notice-form--hidden',\n        visible: 'formhandler__notice-form--visible',\n      },\n    },\n  },\n  fields: {\n    min: false,\n    max: false,\n    send: true,\n  },\n  notices: {\n    attachTo: '.formhandler__notices',\n    nextToField: false,\n    message: false,\n  },\n  classNames: {\n    notices: {\n      block: 'formhandler__notice',\n      hidden: 'formhandler__notice--hidden',\n      visible: 'formhandler__notice--visible',\n    },\n    form: {\n      isValid: 'formhandler--is-valid',\n      isNotValid: 'formhandler--is-not-valid',\n      disabledSubmitButton: 'formhandler__submit--disabled',\n    },\n    fields: {\n      isValid: 'formhandler__field--is-valid',\n      isNotValid: 'formhandler__field--is-not-valid',\n    },\n  },\n  sender: {\n    send: true,\n    type: 'xhr',\n    clearOnSuccess: true,\n  },\n  callbacks: {\n    onFieldChangeState() {},\n    onFormChangeState() {},\n    onSubmit() {},\n    onSend() {},\n  },\n};\n","import Validator from './Validator';\nimport defaultConfig from '../common/defaultConfig';\nimport {\n  HTML_SELECT_ELEMENT,\n  OBJECT,\n  STRING,\n  NODE_LIST,\n} from '../common/constants';\n\nexport default class FormHandlerUtil {\n  constructor({ ...args }) {\n    this.opts = args;\n    this.fields = {};\n    this.notices = {};\n    this.form = null;\n    this.validator = new Validator(this.opts.customValidations);\n    this.callbacks = this.opts.callbacks;\n  }\n\n  complementOptions() {\n    // Add lacks classNames and merge.\n    this.opts.classNames = this.opts.classNames\n      ? { ...defaultConfig.classNames, ...this.opts.classNames }\n      : defaultConfig.classNames;\n    this.opts.classNames.form = {\n      ...defaultConfig.classNames.form,\n      ...this.opts.classNames.form,\n    };\n    this.opts.classNames.fields = {\n      ...defaultConfig.classNames.fields,\n      ...this.opts.classNames.fields,\n    };\n    this.opts.classNames.notices = {\n      ...defaultConfig.classNames.notices,\n      ...this.opts.classNames.notices,\n    };\n\n\n    // Add lacks form options and merge.\n    this.opts.form = this.opts.form\n      ? { ...defaultConfig.form, ...this.opts.form }\n      : defaultConfig.form;\n    this.opts.form.notice = { ...defaultConfig.form.notice, ...this.opts.form.notice };\n    this.opts.form.notice.classNames = {\n      ...this.opts.classNames.notice,\n      ...this.opts.form.notice.classNames,\n    };\n\n\n    // Add lacks notices options and merge\n    this.opts.notices = { ...defaultConfig.notices, ...this.opts.notices };\n\n\n    // Add lacks fields options and merge\n    // eslint-disable-next-line no-unused-vars\n    Object.entries(this.opts.fields).forEach(([name, obj]) => {\n      this.opts.fields[name] = { ...defaultConfig.fields, ...this.opts.fields[name] };\n      this.opts.fields[name].classNames = this.opts.fields[name].classNames\n        ? { ...this.opts.classNames.fields, ...this.opts.fields[name].classNames }\n        : this.opts.classNames.fields;\n      this.opts.fields[name].notice = { ...this.opts.notices, ...this.opts.fields[name].notice };\n      this.opts.fields[name].notice.classNames = {\n        ...this.opts.classNames.notices,\n        ...this.opts.fields[name].notice.classNames,\n      };\n    });\n\n    this.opts.sender = this.opts.sender\n      ? { ...defaultConfig.sender, ...this.opts.sender }\n      : defaultConfig.sender;\n\n    return this;\n  }\n\n  getFieldNameBy(field) { // return field name get by NodeList/Selector(.className)\n    const type = typeof field;\n    const { name } = field;\n    const { node } = this.form;\n    let fieldName;\n\n    if (type === OBJECT) {\n      fieldName = name;\n    }\n    if (type === STRING) {\n      const isSelector = /\\./.test(field);\n\n      if (isSelector) {\n        fieldName = node.querySelector(field).name;\n      } else {\n        fieldName = field;\n      }\n    }\n\n    return fieldName;\n  }\n\n  isFieldValid(field) {\n    return this.fields[this.getFieldNameBy(field)].valid;\n  }\n\n  isFormValid() {\n    return this.form.valid;\n  }\n\n  isFormSubmitted() {\n    return this.form.submitted;\n  }\n\n  isFormSent() {\n    return this.form.sended;\n  }\n\n  clearForm() {\n    this.form.clear();\n  }\n\n  clearField(field) { // Also clears classNames and field of instance like valid, submitted\n    this.fields[this.getFieldNameBy(field)].clear();\n  }\n\n  getField(field) { // Returns a field node\n    return this.fields[this.getFieldNameBy(field)].node;\n  }\n\n  addField(field, { ...opts }) {\n    const options = opts;\n    options.notice = options.notice ? options.notice : {};\n    const name = this.getFieldNameBy(field);\n\n\n    const fieldOptions = {\n      validation: options.validation,\n      min: options.min || defaultConfig.fields.min,\n      max: options.max || defaultConfig.fields.max,\n      send: options.send || defaultConfig.fields.send,\n      classNames: { ...this.opts.classNames.fields, ...options.classNames },\n    };\n\n\n    const noticeOptions = {\n      attachTo: options.notice.attachTo || defaultConfig.notices.attachTo,\n      nextToField: options.notice.nextToField || defaultConfig.notices.nextToField,\n      message: options.notice.message || defaultConfig.notices.message,\n      classNames: { ...this.opts.classNames.notices, ...options.notice.classNames },\n    };\n\n    this.makeField(name, fieldOptions);\n    this.makeNotice(name, noticeOptions);\n\n    return this.fields[name].node;\n  }\n\n  removeField(field) {\n    const name = this.getFieldNameBy(field);\n\n    this.fields[name].remove();\n    this.notices[name].remove();\n  }\n\n  validateField(field) { // also turns on toggleClassNames\n    const name = this.getFieldNameBy(field);\n\n    if (field.validation) {\n      const validation = Validator.validate(this.fields[name].validatorOptions);\n      this.fields[name].submitted = true;\n      this.setFieldState(name, validation.valid);\n    }\n\n    return this.fields[name].node;\n  }\n\n  validateForm() { // also turns on toggleClassNames\n    Object.entries(this.fields).forEach(([name, field]) => {\n      if (field.validation) {\n        const validation = Validator.validate(field.validatorOptions);\n        field.setFieldSubmitted(true);\n        this.setFieldState(name, validation.valid, validation.message);\n      }\n    });\n\n    this.form.submitted = true;\n\n    return this.form.node;\n  }\n\n  getFieldsAndValues() {\n    const data = {};\n\n    Object.entries(this.fields).forEach(([name, field]) => {\n      const type = field.node.constructor.name;\n\n      if (type === NODE_LIST) { // Radio/Checkbox\n        data[name] = [];\n        Array.from(field.node).forEach((node) => {\n          if (node.checked) {\n            data[name].push(node.value);\n          }\n        });\n      } else if (type === HTML_SELECT_ELEMENT) { // Select\n        data[name] = field.node.options[field.node.options.selectedIndex].value;\n      } else { // Others\n        data[name] = field.node.value;\n      }\n    });\n\n    return data;\n  }\n}\n","import Validator from './core/Validator';\nimport Form from './core/Form';\nimport Input from './core/Input';\nimport Radio from './core/Radio';\nimport Select from './core/Select';\nimport Color from './core/Color';\nimport Notice from './core/Notice';\nimport Sender from './core/Sender';\nimport FormHandlerUtil from './core/FormHandlerUtil';\nimport {\n  INPUT,\n  UNDEFINED,\n  ERROR,\n  SUCCESS,\n  OBJECT,\n  LOAD,\n  FORM,\n  CHECKBOX,\n  RADIO,\n  SELECT,\n  COLOR,\n} from './common/constants';\n\nexport default class FormHandler extends FormHandlerUtil {\n  constructor({ ...args }) {\n    super({ ...args });\n    this.init();\n  }\n\n  init() {\n    this.complementOptions().makeForm();\n\n    Object.entries(this.opts.fields).forEach(([name, field]) => {\n      console.log(name, field)\n      this.makeField(name, field);\n      if (field.validation) {\n        this.makeNotice(name, field.notice);\n      }\n    });\n\n    return this;\n  }\n\n  makeForm() {\n    const options = {\n      fields: this.fields,\n      classNames: this.opts.classNames.form,\n      node: document.querySelector(this.opts.form.block),\n      submit: document.querySelector(this.opts.form.submit),\n      listener: this.submitHandler,\n      callback: this.callbacks.onFormChangeState,\n    };\n\n    this.form = new Form(options);\n    this.makeNotice(FORM, this.opts.form.notice);\n\n    return this;\n  }\n\n  makeField(name, field) {\n    let node = this.form.node.querySelector(`[name=${name}]`);\n    const { type } = node;\n    const options = {\n      node,\n      validation: field.validation,\n      min: field.min,\n      max: field.max,\n      send: field.send,\n      classNames: field.classNames,\n      callback: this.callbacks.onFieldChangeState,\n    };\n\n    if (type === RADIO || type === CHECKBOX) {\n      node = this.form.node.querySelectorAll(`[name=${name}]`);\n      options.node = node;\n      this.fields[name] = new Radio(options);\n    } else if (type === SELECT) {\n      this.fields[name] = new Select(options);\n    } else if (type === COLOR) {\n      this.fields[name] = new Color(options);\n    } else {\n      this.fields[name] = new Input(options);\n    }\n\n    this.fields[name].on(INPUT, this.inputHandler);\n    return this;\n  }\n\n  makeNotice(name, notice) {\n    const message = this.fields[name]\n      ? Validator.validate(this.fields[name].validatorOptions).message\n      : false;\n    const parent = notice.nextToField\n      ? this.fields[name].node\n      : document.querySelector(notice.attachTo);\n    const options = {\n      form: this.form.node,\n      classNames: notice.classNames,\n      attachTo: notice.attachTo,\n      message: notice.message || message,\n      nextToField: notice.nextToField,\n      parent,\n    };\n\n    this.notices[name] = new Notice(options);\n\n    return this;\n  }\n\n  setFormStateFromResponse = (result) => {\n    if (result === SUCCESS) {\n      this.notices.form.message = this.opts.form.notice.successMessage;\n      this.form.send = true;\n      if (this.opts.sender.clearOnSuccess) {\n        this.form.clear();\n      }\n    }\n    if (result === ERROR) {\n      this.notices.form.message = this.opts.form.notice.errorMessage;\n      this.form.send = false;\n    }\n    this.notices.form.show();\n  };\n\n  setFieldStateFromResponse(response, property, name, message) {\n    // eslint-disable-next-line valid-typeof\n    if (typeof response.then !== UNDEFINED) {\n      response\n        .then(data => data.json())\n        .then(json => {\n          this.setFieldState(name, !!json[property], message);\n        });\n    } else {\n      response.addEventListener(LOAD, (ev) => {\n        this.setFieldState(name, !!JSON.parse(ev.target.response)[property], message);\n      });\n    }\n  }\n\n  setFieldState(name, valid, message = this.notices[name].message) {\n    const { submitted } = this.fields[name];\n\n    // eslint-disable-next-line valid-typeof\n    if (typeof valid === OBJECT) {\n      this.setFieldStateFromResponse(valid.response, valid.property, name, message);\n    } else {\n      this.fields[name].setFieldState(valid);\n    }\n\n    this.notices[name].message = this.opts.fields[name].message || message;\n    if (!valid && submitted) {\n      this.notices[name].show();\n    } else {\n      this.notices[name].hide();\n    }\n\n    this.form.setFormState();\n\n    return this;\n  }\n\n  inputHandler = (ev) => {\n    const { name } = ev.target;\n    const validation = Validator.validate(this.fields[name].validatorOptions);\n\n    if (this.fields[name].validation) {\n      this.setFieldState(name, validation.valid, validation.message);\n    }\n  };\n\n  submitHandler = (ev) => {\n    ev.preventDefault();\n    const fieldNodes = [];\n\n    // eslint-disable-next-line no-unused-vars\n    Object.entries(this.fields).forEach(([name, field]) => {\n      field.setFieldSubmitted(true);\n      fieldNodes.push(field.node);\n    });\n\n    this.callbacks.onSubmit(this.form.node, fieldNodes);\n\n    this.validateForm();\n\n    if (this.form.valid) {\n      this.notices.form.hide();\n\n      if (this.opts.sender.send) {\n        const options = {\n          type: this.opts.sender.type,\n          url: this.form.node.action,\n          method: this.form.node.method,\n          fields: this.fields,\n          form: this.form.node,\n          callbacks: {\n            setFormState: this.setFormStateFromResponse,\n            onSend: this.callbacks.onSend,\n          },\n        };\n        const sender = new Sender(options);\n\n        sender.sendRequest(sender.makeData());\n\n        setTimeout(() => {\n          this.notices.form.hide();\n        }, 2000);\n      }\n    } else {\n      this.notices.form.show();\n      setTimeout(() => {\n        this.notices.form.hide();\n      }, 2000);\n    }\n  }\n}\n"],"names":["FormHandlerError","props","Error","Validator","custom","addCustomValidations","Object","entries","forEach","type","obj","validations","node","min","max","validation","isCheckboxChecked","message","valid","checked","el","isRadioChecked","Array","from","some","isSelected","options","filter","value","length","selected","isName","pattern","test","console","log","isEmail","isPhone","isNonEmpty","HTML_SELECT_ELEMENT","INPUT","LOAD","UNDEFINED","SUCCESS","ERROR","OBJECT","FORM","CLICK","DIV","READY_STATE_CHANGE","XHR","FETCH","AFTER","BEFORE","STRING","CHECKBOX","RADIO","SELECT","NODE_LIST","COLOR","Form","opts","submit","classNames","fields","listener","submitted","sended","callback","addEventListener","validity","fieldsValidity","toggleClassNames","classList","remove","isNotValid","add","isValid","name","field","clear","validness","Set","has","Field","send","constructor","removeEventListener","Input","Radio","Select","Color","Notice","form","attachTo","nextToField","parent","mount","document","createElement","block","hidden","appendChild","insertBefore","nextElementSibling","visible","innerText","Sender","url","method","callbacks","data","FormData","append","selectedIndex","xhr","XMLHttpRequest","open","ev","target","readyState","status","setFormState","onSend","statusText","fetch","body","then","response","notice","successMessage","errorMessage","notices","disabledSubmitButton","sender","clearOnSuccess","onFieldChangeState","onFormChangeState","onSubmit","FormHandlerUtil","args","validator","customValidations","defaultConfig","fieldName","isSelector","querySelector","getFieldNameBy","fieldOptions","noticeOptions","makeField","makeNotice","validate","validatorOptions","setFieldState","setFieldSubmitted","push","FormHandler","result","show","preventDefault","fieldNodes","validateForm","hide","action","setFormStateFromResponse","sendRequest","makeData","setTimeout","init","complementOptions","makeForm","submitHandler","querySelectorAll","on","inputHandler","property","json","JSON","parse","setFieldStateFromResponse"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;MACqBA;;;;;EACnB,4BAAYC,KAAZ,EAAmB;EAAA;;EAAA,yFACXA,KADW;EAElB;;;qBAH2CC;;MCEzBC;;;EACnB,qBAAYC,MAAZ,EAAoB;EAAA;;EAClB,SAAKA,MAAL,GAAcA,MAAd;EAEA,SAAKC,oBAAL;EACD;;;;6CAEsB;EACrBC,aAAOC,OAAP,CAAe,KAAKH,MAApB,EAA4BI,OAA5B,CAAoC,gBAAiB;EAAA;EAAA,YAAfC,IAAe;EAAA,YAATC,GAAS;;EACnDP,kBAAUQ,WAAV,CAAsBF,IAAtB,IAA8BC,GAA9B;EACD,OAFD;EAGA,aAAO,IAAP;EACD;;;sCAIE;EAAA,UADDD,IACC,SADDA,IACC;EAAA,UADKG,IACL,SADKA,IACL;EAAA,UADWC,GACX,SADWA,GACX;EAAA,UADgBC,GAChB,SADgBA,GAChB;EACD,UAAI,CAACL,IAAL,EAAW;EACX,UAAMM,aAAaZ,UAAUQ,WAAV,CAAsBF,IAAtB,CAAnB;;EAEA,UAAI,CAACM,UAAL,EAAiB;EACf,cAAM,IAAIf,gBAAJ,uCAAoDS,IAApD,EAAN;EACD,OANA;;;EASD,aAAOM,WAAWH,IAAX,EAAiBC,GAAjB,EAAsBC,GAAtB,CAAP;EACD;;;;;;kBA1BkBX,0BA4BE;EACnBa,mBADmB,6BACDJ,IADC,EACKC,GADL,EACUC,GADV,EACe;EAChC,QAAMG,UAAU,iBAAhB;EACA,QAAIC,QAAQ,KAAZ;EACA,QAAIC,UAAU,CAAd;EAEAP,SAAKJ,OAAL,CAAa,UAACY,EAAD,EAAQ;EACnB,UAAIA,GAAGD,OAAP,EAAgBA,WAAW,CAAX;EACjB,KAFD;;EAIA,QAAIN,OAAOC,GAAX,EAAgB;EACdI,cAAQ,CAAC,EAAEL,OAAOC,GAAP,IAAcK,WAAWN,GAAzB,IAAgCM,WAAWL,GAA7C,CAAT;EACD;;EACD,QAAID,OAAO,CAACC,GAAZ,EAAiB;EACfI,cAAQC,WAAWN,GAAnB;EACD;;EACD,QAAI,CAACA,GAAD,IAAQC,GAAZ,EAAiB;EACfI,cAAQC,WAAWL,GAAnB;EACD;;EAED,WAAO;EACLI,kBADK;EAELD;EAFK,KAAP;EAID,GAxBkB;EAyBnBI,gBAzBmB,0BAyBJT,IAzBI,EAyBE;EACnB,QAAMM,QAAQI,MAAMC,IAAN,CAAWX,IAAX,EAAiBY,IAAjB,CAAsB;EAAA,aAAMJ,GAAGD,OAAH,KAAe,IAArB;EAAA,KAAtB,CAAd;EAGA,QAAMF,UAAU,0BAAhB;EAEA,WAAO;EACLC,kBADK;EAELD;EAFK,KAAP;EAID,GAnCkB;EAoCnBQ,YApCmB,sBAoCRb,IApCQ,EAoCF;EACf,QAAMM,QAAQI,MAAMC,IAAN,CAAWX,KAAKc,OAAhB,EACXC,MADW,CACJ;EAAA,aAAMP,GAAGQ,KAAH,CAASC,MAAT,GAAkB,CAAxB;EAAA,KADI,EAEXL,IAFW,CAEN;EAAA,aAAMJ,GAAGU,QAAH,KAAgB,IAAtB;EAAA,KAFM,CAAd;EAKA,QAAMb,UAAU,2BAAhB;EACA,WAAO;EACLC,kBADK;EAELD;EAFK,KAAP;EAID,GA/CkB;EAgDnBc,QAhDmB,kBAgDZnB,IAhDY,EAgDNC,GAhDM,EAgDDC,GAhDC,EAgDI;EACrB,QAAMkB,UAAU,WAAhB;EACA,QAAId,QAAQc,QAAQC,IAAR,CAAarB,KAAKgB,KAAlB,CAAZ;EACA,QAAIX,UAAU,kCAAd;;EAEA,QAAIL,KAAKgB,KAAL,CAAWC,MAAX,KAAsB,CAA1B,EAA6B;EAC3BX,cAAQ,KAAR;;EACA,UAAIL,OAAO,CAACC,GAAZ,EAAiB;EACfG,kDAAmCJ,GAAnC;EACD;;EACD,UAAI,CAACA,GAAD,IAAQC,GAAZ,EAAiB;EACfG,oFAAqEH,MAAM,CAA3E;EACD;;EACD,UAAID,OAAOC,GAAX,EAAgB;EACdG,iDAAkCJ,GAAlC,kBAA6CC,GAA7C;EACD;EACF,KAXD,MAWO;EACL,UAAID,OAAOD,KAAKgB,KAAL,CAAWC,MAAX,GAAoBhB,GAA/B,EAAoC;EAClCK,gBAAQ,KAAR;EACAD,kDAAmCJ,GAAnC;EACD;;EAED,UAAIA,OAAOD,KAAKgB,KAAL,CAAWC,MAAX,GAAoBhB,GAA/B,EAAoC;EAClCK,gBAAQ,IAAR;EACD;;EACD,UAAIJ,OAAOF,KAAKgB,KAAL,CAAWC,MAAX,GAAoBf,GAA/B,EAAoC;EAClCI,gBAAQ,KAAR;EACAD,mDAAoCH,MAAM,CAA1C;EACD;EACF;;EACDoB,YAAQC,GAAR,CAAYlB,OAAZ;EAGA,WAAO;EACLC,kBADK;EAELD;EAFK,KAAP;EAID,GArFkB;EAsFnBmB,SAtFmB,mBAsFXxB,IAtFW,EAsFL;EACZ,QAAMoB,UAAU,wHAAhB;EACA,QAAMd,QAAQc,QAAQC,IAAR,CAAarB,KAAKgB,KAAlB,CAAd;EAGA,QAAMX,UAAU,+BAAhB;EAEA,WAAO;EACLC,kBADK;EAELD;EAFK,KAAP;EAID,GAjGkB;EAkGnBoB,SAlGmB,mBAkGXzB,IAlGW,EAkGL;EACZ,QAAMoB,UAAU,gDAAhB;EACA,QAAMd,QAAQc,QAAQC,IAAR,CAAarB,KAAKgB,KAAlB,CAAd;EACA,QAAMX,UAAU,mCAAhB;EAEA,WAAO;EACLC,kBADK;EAELD;EAFK,KAAP;EAID,GA3GkB;EA4GnBqB,YA5GmB,sBA4GR1B,IA5GQ,EA4GFC,GA5GE,EA4GGC,GA5GH,EA4GQ;EACzB,QAAII,QAAQN,KAAKgB,KAAL,CAAWC,MAAX,GAAoB,CAAhC;EAGA,QAAMZ,UAAU,mBAAhB;;EAEA,QAAIJ,OAAOD,KAAKgB,KAAL,CAAWC,MAAX,GAAoBhB,GAA3B,IAAkCD,KAAKgB,KAAL,CAAWC,MAAX,KAAsB,CAA5D,EAA+D;EAC7DX,cAAQ,KAAR;EACD;;EACD,QAAIJ,OAAOF,KAAKgB,KAAL,CAAWC,MAAX,GAAoBf,GAA3B,IAAkCF,KAAKgB,KAAL,CAAWC,MAAX,KAAsB,CAA5D,EAA+D;EAC7DX,cAAQ,KAAR;EACD;;EAED,WAAO;EACLA,kBADK;EAELD;EAFK,KAAP;EAID;EA7HkB;;EC/BhB,IAAMsB,sBAAsB,mBAA5B;AACP,EAAO,IAAMC,QAAQ,OAAd;AACP,EAAO,IAAMC,OAAO,MAAb;AACP,EAAO,IAAMC,YAAY,WAAlB;AACP,EAAO,IAAMC,UAAU,SAAhB;AACP,EAAO,IAAMC,QAAQ,OAAd;AACP,EAAO,IAAMC,SAAS,QAAf;AACP,EAAO,IAAMC,OAAO,MAAb;AACP,EAAO,IAAMC,QAAQ,OAAd;AACP,EAAO,IAAMC,MAAM,KAAZ;AACP,EAAO,IAAMC,qBAAqB,kBAA3B;AACP,EAAO,IAAMC,MAAM,KAAZ;AACP,EAAO,IAAMC,QAAQ,OAAd;AACP,EAAO,IAAMC,QAAQ,OAAd;AACP,EAAO,IAAMC,SAAS,QAAf;AACP,EAAO,IAAMC,SAAS,QAAf;AACP,EAAO,IAAMC,WAAW,UAAjB;AACP,EAAO,IAAMC,QAAQ,OAAd;AACP,EAAO,IAAMC,SAAS,YAAf;AACP,EAAO,IAAMC,YAAY,UAAlB;AACP,EAAO,IAAMC,QAAQ,OAAd;;MChBcC;;;EACnB,sBAAyB;EAAA,QAARC,IAAQ;;EAAA;;EACvB,SAAKjD,IAAL,GAAYiD,KAAKjD,IAAjB;EACA,SAAKkD,MAAL,GAAcD,KAAKC,MAAnB;EACA,SAAKC,UAAL,GAAkBF,KAAKE,UAAvB;EACA,SAAKC,MAAL,GAAcH,KAAKG,MAAnB;EACA,SAAKC,QAAL,GAAgBJ,KAAKI,QAArB;EACA,SAAK/C,KAAL,GAAa,KAAb;EACA,SAAKgD,SAAL,GAAiB,KAAjB;EACA,SAAKC,MAAL,GAAc,IAAd;EACA,SAAKC,QAAL,GAAgBP,KAAKO,QAArB;EAEA,SAAKN,MAAL,CAAYO,gBAAZ,CAA6BtB,KAA7B,EAAoC,KAAKkB,QAAzC;EACD;;;;qCAec;EACb,UAAMK,WAAW,KAAKC,cAAtB;EACArC,cAAQC,GAAR,CAAYmC,QAAZ;EAEA,WAAKF,QAAL,CAAc,KAAKxD,IAAnB,EAAyB,KAAKM,KAA9B,EAAqCoD,QAArC;EAEA,WAAKpD,KAAL,GAAaoD,QAAb;;EAEA,UAAI,KAAKJ,SAAT,EAAoB;EAClB,aAAKM,gBAAL;EACD;EACF;;;yCAEkB;EACjB,UAAI,KAAKtD,KAAT,EAAgB;EACd,aAAKN,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBY,UAA3C;EACA,aAAK/D,IAAL,CAAU6D,SAAV,CAAoBG,GAApB,CAAwB,KAAKb,UAAL,CAAgBc,OAAxC;EACD,OAHD,MAGO;EACL,aAAKjE,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBc,OAA3C;EACA,aAAKjE,IAAL,CAAU6D,SAAV,CAAoBG,GAApB,CAAwB,KAAKb,UAAL,CAAgBY,UAAxC;EACD;EACF;;;8BAEO;EACN;EACArE,aAAOC,OAAP,CAAe,KAAKyD,MAApB,EAA4BxD,OAA5B,CAAoC,iBAAmB;EAAA;EAAA,YAAjBsE,IAAiB;EAAA,YAAXC,KAAW;;EACrDA,cAAMC,KAAN;EACD,OAFD;EAIA,WAAKZ,QAAL,CAAc,KAAKxD,IAAnB,EAAyB,KAAKM,KAA9B,EAAqC,KAArC;EACA,WAAKA,KAAL,GAAa,KAAb;EACA,WAAKN,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBY,UAA3C;EACA,WAAK/D,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBc,OAA3C;EACD;;;0BA9CoB;EACnB,UAAMI,YAAY,IAAIC,GAAJ,EAAlB,CADmB;;EAInB5E,aAAOC,OAAP,CAAe,KAAKyD,MAApB,EAA4BxD,OAA5B,CAAoC,iBAAmB;EAAA;EAAA,YAAjBsE,IAAiB;EAAA,YAAXC,KAAW;;EACrD,YAAIA,MAAMhE,UAAV,EAAsB;EACpBkE,oBAAUL,GAAV,CAAcG,MAAM7D,KAApB;EACD;EACF,OAJD;EAMA,aAAO,CAAC+D,UAAUE,GAAV,CAAc,KAAd,CAAR;EACD;;;;;;MC1BkBC;;;EACnB,uBAEG;EAAA,QADDxE,IACC,QADDA,IACC;EAAA,QADKG,UACL,QADKA,UACL;EAAA,QADiBF,GACjB,QADiBA,GACjB;EAAA,QADsBC,GACtB,QADsBA,GACtB;EAAA,QAD2BuE,IAC3B,QAD2BA,IAC3B;EAAA,QADiCtB,UACjC,QADiCA,UACjC;EAAA,QAD6CK,QAC7C,QAD6CA,QAC7C;;EAAA;;EACD,SAAKxD,IAAL,GAAYA,IAAZ;EACA,SAAKH,IAAL,GAAY,KAAKG,IAAL,CAAU0E,WAAV,CAAsBR,IAAlC;EACA,SAAKA,IAAL,GAAY,KAAKrE,IAAL,KAAciD,SAAd,GAA0B,KAAK9C,IAAL,CAAU,CAAV,EAAakE,IAAvC,GAA8C,KAAKlE,IAAL,CAAUkE,IAApE;EACA,SAAK/D,UAAL,GAAkBA,UAAlB;EACA,SAAKsE,IAAL,GAAYA,IAAZ;EACA,SAAKxE,GAAL,GAAWA,GAAX;EACA,SAAKC,GAAL,GAAWA,GAAX;EACA,SAAKiD,UAAL,GAAkBA,UAAlB;EACA,SAAK7C,KAAL,GAAa,KAAb;EACA,SAAKgD,SAAL,GAAiB,KAAjB;EACA,SAAKE,QAAL,GAAgBA,QAAhB;EACD;;;;wCAWiBxC,OAAO;EACvB,WAAKsC,SAAL,GAAiBtC,KAAjB;EACD;;;yBAEEnB,MAAMwD,UAAU;EACjB,UAAI,KAAKxD,IAAL,KAAciD,SAAlB,EAA6B;EAC3B,aAAK9C,IAAL,CAAUJ,OAAV,CAAkB;EAAA,iBAAMY,GAAGiD,gBAAH,CAAoB5D,IAApB,EAA0BwD,QAA1B,CAAN;EAAA,SAAlB;EACD,OAFD,MAEO;EACL,aAAKrD,IAAL,CAAUyD,gBAAV,CAA2B5D,IAA3B,EAAiCwD,QAAjC;EACD;EACF;;;0BAEGxD,MAAMwD,UAAU;EAClB,UAAI,KAAKxD,IAAL,KAAciD,SAAlB,EAA6B;EAC3B,aAAK9C,IAAL,CAAUJ,OAAV,CAAkB;EAAA,iBAAMY,GAAGmE,mBAAH,CAAuB9E,IAAvB,EAA6BwD,QAA7B,CAAN;EAAA,SAAlB;EACD,OAFD,MAEO;EACL,aAAKrD,IAAL,CAAU2E,mBAAV,CAA8B9E,IAA9B,EAAoCwD,QAApC;EACD;EACF;;;+BAEQ;EACP,WAAKrD,IAAL,CAAU8D,MAAV;EACD;;;0BA/BsB;EACrB,aAAO;EACLjE,cAAM,KAAKM,UADN;EAELH,cAAM,KAAKA,IAFN;EAGLC,aAAK,KAAKA,GAHL;EAILC,aAAK,KAAKA;EAJL,OAAP;EAMD;;;;;;MC1BkB0E;;;;;EACnB,uBAAyB;EAAA,QAAR3B,IAAQ;;EAAA;;EAAA,gGACZA,IADY;EAExB;;;;oCAEa3C,OAAO;EACnB,WAAKkD,QAAL,CAAc,KAAKU,IAAnB,EAAyB,KAAKlE,IAA9B,EAAoC,KAAKM,KAAzC,EAAgDA,KAAhD;EAEA,WAAKA,KAAL,GAAaA,KAAb;;EAEA,UAAI,KAAKgD,SAAT,EAAoB;EAClB,aAAKM,gBAAL;EACD;EACF;;;yCAEkB;EACjB,UAAI,KAAKtD,KAAT,EAAgB;EACd,aAAKN,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBY,UAA3C;EACA,aAAK/D,IAAL,CAAU6D,SAAV,CAAoBG,GAApB,CAAwB,KAAKb,UAAL,CAAgBc,OAAxC;EACD,OAHD,MAGO;EACL,aAAKjE,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBc,OAA3C;EACA,aAAKjE,IAAL,CAAU6D,SAAV,CAAoBG,GAApB,CAAwB,KAAKb,UAAL,CAAgBY,UAAxC;EACD;EACF;;;8BAEO;EACN,WAAKP,QAAL,CAAc,KAAKU,IAAnB,EAAyB,KAAKlE,IAA9B,EAAoC,KAAKM,KAAzC,EAAgD,KAAhD;EACA,WAAKN,IAAL,CAAUgB,KAAV,GAAkB,EAAlB;EACA,WAAKV,KAAL,GAAa,KAAb;EACA,WAAKgD,SAAL,GAAiB,KAAjB;EACA,WAAKtD,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBY,UAA3C;EACA,WAAK/D,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBc,OAA3C;EACD;;;;IAhCgCO;;MCAdK;;;;;EACnB,uBAAyB;EAAA,QAAR5B,IAAQ;;EAAA;;EAAA,gGACZA,IADY;EAExB;;;;oCAEa3C,OAAO;EACnB,WAAKkD,QAAL,CAAc,KAAKU,IAAnB,EAAyB,KAAKlE,IAA9B,EAAoC,KAAKM,KAAzC,EAAgDA,KAAhD;EAEA,WAAKA,KAAL,GAAaA,KAAb;;EAEA,UAAI,KAAKgD,SAAT,EAAoB;EAClB,aAAKM,gBAAL;EACD;EACF;;;yCAEkB;EAAA;;EACjB,UAAI,KAAKtD,KAAT,EAAgB;EACd,aAAKN,IAAL,CAAUJ,OAAV,CAAkB;EAAA,iBAAMY,GAAGqD,SAAH,CAAaC,MAAb,CAAoB,MAAKX,UAAL,CAAgBY,UAApC,CAAN;EAAA,SAAlB;EACA,aAAK/D,IAAL,CAAUJ,OAAV,CAAkB;EAAA,iBAAMY,GAAGqD,SAAH,CAAaG,GAAb,CAAiB,MAAKb,UAAL,CAAgBc,OAAjC,CAAN;EAAA,SAAlB;EACD,OAHD,MAGO;EACL,aAAKjE,IAAL,CAAUJ,OAAV,CAAkB;EAAA,iBAAMY,GAAGqD,SAAH,CAAaC,MAAb,CAAoB,MAAKX,UAAL,CAAgBc,OAApC,CAAN;EAAA,SAAlB;EACA,aAAKjE,IAAL,CAAUJ,OAAV,CAAkB;EAAA,iBAAMY,GAAGqD,SAAH,CAAaG,GAAb,CAAiB,MAAKb,UAAL,CAAgBY,UAAjC,CAAN;EAAA,SAAlB;EACD;EACF;;;8BAEO;EAAA;;EACN,WAAKP,QAAL,CAAc,KAAKU,IAAnB,EAAyB,KAAKlE,IAA9B,EAAoC,KAAKM,KAAzC,EAAgD,KAAhD;EACA,WAAKA,KAAL,GAAa,KAAb;EACA,WAAKgD,SAAL,GAAiB,KAAjB;EACA,WAAKtD,IAAL,CAAUJ,OAAV,CAAkB;EAAA,eAAMY,GAAGqD,SAAH,CAAaC,MAAb,CAAoB,OAAKX,UAAL,CAAgBc,OAApC,CAAN;EAAA,OAAlB;EACA,WAAKjE,IAAL,CAAUJ,OAAV,CAAkB;EAAA,eAAMY,GAAGqD,SAAH,CAAaC,MAAb,CAAoB,OAAKX,UAAL,CAAgBY,UAApC,CAAN;EAAA,OAAlB;EACA,WAAK/D,IAAL,CAAUJ,OAAV,CAAkB,UAACY,EAAD,EAAQ;EACxB;EACAA,WAAGD,OAAH,GAAa,KAAb;EACD,OAHD;EAID;;;;IAnCgCiE;;MCAdM;;;;;EACnB,wBAAyB;EAAA,QAAR7B,IAAQ;;EAAA;;EAAA,iGACZA,IADY;EAExB;;;;oCAEa3C,OAAO;EACnB,WAAKkD,QAAL,CAAc,KAAKU,IAAnB,EAAyB,KAAKlE,IAA9B,EAAoC,KAAKM,KAAzC,EAAgDA,KAAhD;EAEA,WAAKA,KAAL,GAAaA,KAAb;;EAEA,UAAI,KAAKgD,SAAT,EAAoB;EAClB,aAAKM,gBAAL;EACD;EACF;;;yCAEkB;EACjB,UAAI,KAAKtD,KAAT,EAAgB;EACd,aAAKN,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBY,UAA3C;EACA,aAAK/D,IAAL,CAAU6D,SAAV,CAAoBG,GAApB,CAAwB,KAAKb,UAAL,CAAgBc,OAAxC;EACD,OAHD,MAGO;EACL,aAAKjE,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBc,OAA3C;EACA,aAAKjE,IAAL,CAAU6D,SAAV,CAAoBG,GAApB,CAAwB,KAAKb,UAAL,CAAgBY,UAAxC;EACD;EACF;;;8BAEO;EACN,WAAKP,QAAL,CAAc,KAAKU,IAAnB,EAAyB,KAAKlE,IAA9B,EAAoC,KAAKM,KAAzC,EAAgD,KAAhD;EACA,WAAKA,KAAL,GAAa,KAAb;EACA,WAAKgD,SAAL,GAAiB,KAAjB;EACA,WAAKtD,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBc,OAA3C;EACA,WAAKjE,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBY,UAA3C;EACArD,YAAMC,IAAN,CAAW,KAAKX,IAAL,CAAUc,OAArB,EAA8BlB,OAA9B,CAAsC,UAACY,EAAD,EAAQ;EAC5CA,WAAGU,QAAH,GAAc,KAAd;EACD,OAFD;EAGD;;;;IAlCiCsD;;MCAfO;;;;;EACnB,uBAAyB;EAAA,QAAR9B,IAAQ;;EAAA;;EAAA,gGACZA,IADY;EAExB;;;;oCAEa3C,OAAO;EACnB,WAAKkD,QAAL,CAAc,KAAKU,IAAnB,EAAyB,KAAKlE,IAA9B,EAAoC,KAAKM,KAAzC,EAAgDA,KAAhD;EAEA,WAAKA,KAAL,GAAaA,KAAb;;EAEA,UAAI,KAAKgD,SAAT,EAAoB;EAClB,aAAKM,gBAAL;EACD;EACF;;;yCAEkB;EACjB,UAAI,KAAKtD,KAAT,EAAgB;EACd,aAAKN,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBY,UAA3C;EACA,aAAK/D,IAAL,CAAU6D,SAAV,CAAoBG,GAApB,CAAwB,KAAKb,UAAL,CAAgBc,OAAxC;EACD,OAHD,MAGO;EACL,aAAKjE,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBc,OAA3C;EACA,aAAKjE,IAAL,CAAU6D,SAAV,CAAoBG,GAApB,CAAwB,KAAKb,UAAL,CAAgBY,UAAxC;EACD;EACF;;;8BAEO;EACN,WAAKP,QAAL,CAAc,KAAKU,IAAnB,EAAyB,KAAKlE,IAA9B,EAAoC,KAAKM,KAAzC,EAAgD,KAAhD;EACA,WAAKN,IAAL,CAAUgB,KAAV,GAAkB,SAAlB;EACA,WAAKV,KAAL,GAAa,KAAb;EACA,WAAKgD,SAAL,GAAiB,KAAjB;EACA,WAAKtD,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBY,UAA3C;EACA,WAAK/D,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBc,OAA3C;EACD;;;;IAhCgCO;;MCIdQ;;;EACnB,wBAEG;EAAA,QADDC,IACC,QADDA,IACC;EAAA,QADK5E,OACL,QADKA,OACL;EAAA,QADc8C,UACd,QADcA,UACd;EAAA,QAD0B+B,QAC1B,QAD0BA,QAC1B;EAAA,QADoCC,WACpC,QADoCA,WACpC;EAAA,QADiDC,MACjD,QADiDA,MACjD;;EAAA;;EACD,SAAKH,IAAL,GAAYA,IAAZ;EACA,SAAK5E,OAAL,GAAeA,OAAf;EACA,SAAK8C,UAAL,GAAkBA,UAAlB;EACA,SAAK+B,QAAL,GAAgBA,QAAhB;EACA,SAAKC,WAAL,GAAmBA,WAAnB;EACA,SAAKC,MAAL,GAAcA,MAAd;EACA,SAAKpF,IAAL,GAAY,IAAZ;EACA,SAAKqF,KAAL;EACD;;;;8BAEO;EACN,WAAKrF,IAAL,GAAYsF,SAASC,aAAT,CAAuBnD,GAAvB,CAAZ;EACA,WAAKpC,IAAL,CAAU6D,SAAV,CAAoBG,GAApB,CAAwB,KAAKb,UAAL,CAAgBqC,KAAxC;EACA,WAAKxF,IAAL,CAAU6D,SAAV,CAAoBG,GAApB,CAAwB,KAAKb,UAAL,CAAgBsC,MAAxC;;EAEA,UAAI,KAAKP,QAAT,EAAmB;EACjB,aAAKE,MAAL,CAAYM,WAAZ,CAAwB,KAAK1F,IAA7B;EACD,OAFD,MAEO;EACL,YAAI,KAAKmF,WAAL,KAAqB1C,MAAzB,EAAiC;EAC/B,eAAKwC,IAAL,CAAUU,YAAV,CAAuB,KAAK3F,IAA5B,EAAkC,KAAKoF,MAAvC;EACD;;EACD,YAAI,KAAKD,WAAL,KAAqB3C,KAAzB,EAAgC;EAC9B,eAAKyC,IAAL,CAAUU,YAAV,CAAuB,KAAK3F,IAA5B,EAAkC,KAAKoF,MAAL,CAAYQ,kBAA9C;EACD;EACF;EACF;;;6BAEM;EACL,WAAK5F,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgBsC,MAA3C;EACA,WAAKzF,IAAL,CAAU6D,SAAV,CAAoBG,GAApB,CAAwB,KAAKb,UAAL,CAAgB0C,OAAxC;EACA,WAAK7F,IAAL,CAAU8F,SAAV,GAAsB,KAAKzF,OAA3B;EACD;;;6BAEM;EACL,WAAKL,IAAL,CAAU6D,SAAV,CAAoBC,MAApB,CAA2B,KAAKX,UAAL,CAAgB0C,OAA3C;EACA,WAAK7F,IAAL,CAAU6D,SAAV,CAAoBG,GAApB,CAAwB,KAAKb,UAAL,CAAgBsC,MAAxC;EACD;;;+BAEQ;EACP,WAAKzF,IAAL,CAAU8D,MAAV;EACD;;;;;;MCvCkBiC;;;EACnB,wBAEG;EAAA,QADDlG,IACC,QADDA,IACC;EAAA,QADKmG,GACL,QADKA,GACL;EAAA,QADUC,MACV,QADUA,MACV;EAAA,QADkB7C,MAClB,QADkBA,MAClB;EAAA,QAD0B6B,IAC1B,QAD0BA,IAC1B;EAAA,QADgCiB,SAChC,QADgCA,SAChC;;EAAA;;EACD,SAAKrG,IAAL,GAAYA,IAAZ;EACA,SAAKmG,GAAL,GAAWA,GAAX;EACA,SAAKC,MAAL,GAAcA,MAAd;EACA,SAAK7C,MAAL,GAAcA,MAAd;EACA,SAAK6B,IAAL,GAAYA,IAAZ;EACA,SAAKiB,SAAL,GAAiBA,SAAjB;EACD;;;;iCAEU;EACT,UAAMC,OAAO,IAAIC,QAAJ,EAAb,CADS;;EAIT1G,aAAOC,OAAP,CAAe,KAAKyD,MAApB,EAA4BxD,OAA5B,CAAoC,iBAAmB;EAAA;EAAA,YAAjBsE,IAAiB;EAAA,YAAXC,KAAW;;EACrD,YAAI,CAACA,MAAMM,IAAX,EAAiB;EACjB,YAAM5E,OAAOsE,MAAMnE,IAAN,CAAW0E,WAAX,CAAuBR,IAApC;;EAEA,YAAIrE,SAASiD,SAAb,EAAwB;EAAE;EACxBpC,gBAAMC,IAAN,CAAWwD,MAAMnE,IAAjB,EAAuBJ,OAAvB,CAA+B,UAACI,IAAD,EAAU;EACvC,gBAAIA,KAAKO,OAAT,EAAkB;EAChB4F,mBAAKE,MAAL,CAAYlC,MAAMD,IAAlB,EAAwBlE,KAAKgB,KAA7B;EACD;EACF,WAJD;EAKD,SAND,MAMO,IAAInB,SAAS8B,mBAAb,EAAkC;EACvCwE,eAAKE,MAAL,CAAYlC,MAAMD,IAAlB,EAAwBC,MAAMnE,IAAN,CAAWc,OAAX,CAAmBqD,MAAMnE,IAAN,CAAWc,OAAX,CAAmBwF,aAAtC,EAAqDtF,KAA7E;EACD,SAFM,MAEA;EAAE;EACPmF,eAAKE,MAAL,CAAYlC,MAAMD,IAAlB,EAAwBC,MAAMnE,IAAN,CAAWgB,KAAnC;EACD;EACF,OAfD;EAiBA,aAAOmF,IAAP;EACD;;;kCAEWA,MAAM;EAAA;;EAChB,UAAI,KAAKtG,IAAL,KAAcyC,GAAlB,EAAuB;EACrB,YAAMiE,MAAM,IAAIC,cAAJ,EAAZ;EACAD,YAAIE,IAAJ,CAAS,KAAKR,MAAd,EAAsB,KAAKD,GAA3B,EAAgC,IAAhC;EACAO,YAAI9C,gBAAJ,CAAqBpB,kBAArB,EAAyC,UAACqE,EAAD,EAAQ;EAC/C,cAAIA,GAAGC,MAAH,CAAUC,UAAV,KAAyB,CAA7B,EAAgC;EAC9B,gBAAIF,GAAGC,MAAH,CAAUE,MAAV,IAAoB,GAApB,IAA2BH,GAAGC,MAAH,CAAUE,MAAV,GAAmB,GAAlD,EAAuD;EACrD,oBAAKX,SAAL,CAAeY,YAAf,CAA4B/E,OAA5B;;EACA,oBAAKmE,SAAL,CAAea,MAAf,CAAsBhF,OAAtB;EACD,aAHD,MAGO;EACL,oBAAKmE,SAAL,CAAeY,YAAf,CAA4B9E,KAA5B;;EACA,oBAAKkE,SAAL,CAAea,MAAf,CAAsB/E,KAAtB;;EACA,oBAAM,IAAI5C,gBAAJ,mBAAgCsH,GAAGC,MAAH,CAAUE,MAA1C,qBAA2DH,GAAGC,MAAH,CAAUK,UAArE,EAAN;EACD;EACF;EACF,SAXD;EAYAT,YAAI9B,IAAJ,CAAS0B,IAAT;EACD;;EAED,UAAI,KAAKtG,IAAL,KAAc0C,KAAlB,EAAyB;EACvB0E,cAAM,KAAKjB,GAAX,EAAgB;EACdC,kBAAQ,KAAKA,MADC;EAEdiB,gBAAMf;EAFQ,SAAhB,EAGGgB,IAHH,CAGQ,UAACC,QAAD,EAAc;EACpB,cAAIA,SAASP,MAAT,IAAmB,GAAnB,IAA0BO,SAASP,MAAT,GAAkB,GAAhD,EAAqD;EACnD,kBAAKX,SAAL,CAAeY,YAAf,CAA4B/E,OAA5B;;EACA,kBAAKmE,SAAL,CAAea,MAAf,CAAsBhF,OAAtB;EACD,WAHD,MAGO;EACL,kBAAKmE,SAAL,CAAeY,YAAf,CAA4B9E,KAA5B;;EACA,kBAAKkE,SAAL,CAAea,MAAf,CAAsB/E,KAAtB;;EACA,kBAAM,IAAI5C,gBAAJ,mBAAgCgI,SAASP,MAAzC,qBAA0DO,SAASJ,UAAnE,EAAN;EACD;EACF,SAZD;EAaD;EACF;;;;;;ACjFH,sBAAe;EACb/B,QAAM;EACJO,WAAO,cADH;EAEJtC,YAAQ,sBAFJ;EAGJmE,YAAQ;EACNnC,gBAAU,uBADJ;EAEN7E,eAAS,uBAFH;EAGNiH,sBAAgB,IAHV;EAINC,oBAAc,MAJR;EAKNpE,kBAAY;EACVqC,eAAO,0BADG;EAEVC,gBAAQ,kCAFE;EAGVI,iBAAS;EAHC;EALN;EAHJ,GADO;EAgBbzC,UAAQ;EACNnD,SAAK,KADC;EAENC,SAAK,KAFC;EAGNuE,UAAM;EAHA,GAhBK;EAqBb+C,WAAS;EACPtC,cAAU,uBADH;EAEPC,iBAAa,KAFN;EAGP9E,aAAS;EAHF,GArBI;EA0Bb8C,cAAY;EACVqE,aAAS;EACPhC,aAAO,qBADA;EAEPC,cAAQ,6BAFD;EAGPI,eAAS;EAHF,KADC;EAMVZ,UAAM;EACJhB,eAAS,uBADL;EAEJF,kBAAY,2BAFR;EAGJ0D,4BAAsB;EAHlB,KANI;EAWVrE,YAAQ;EACNa,eAAS,8BADH;EAENF,kBAAY;EAFN;EAXE,GA1BC;EA0Cb2D,UAAQ;EACNjD,UAAM,IADA;EAEN5E,UAAM,KAFA;EAGN8H,oBAAgB;EAHV,GA1CK;EA+CbzB,aAAW;EACT0B,sBADS,gCACY,EADZ;EAETC,qBAFS,+BAEW,EAFX;EAGTC,YAHS,sBAGE,EAHF;EAITf,UAJS,oBAIA;EAJA;EA/CE,CAAf;;MCSqBgB;;;EACnB,iCAAyB;EAAA,QAARC,IAAQ;;EAAA;;EACvB,SAAK/E,IAAL,GAAY+E,IAAZ;EACA,SAAK5E,MAAL,GAAc,EAAd;EACA,SAAKoE,OAAL,GAAe,EAAf;EACA,SAAKvC,IAAL,GAAY,IAAZ;EACA,SAAKgD,SAAL,GAAiB,IAAI1I,SAAJ,CAAc,KAAK0D,IAAL,CAAUiF,iBAAxB,CAAjB;EACA,SAAKhC,SAAL,GAAiB,KAAKjD,IAAL,CAAUiD,SAA3B;EACD;;;;0CAEmB;EAAA;;EAClB;EACA,WAAKjD,IAAL,CAAUE,UAAV,GAAuB,KAAKF,IAAL,CAAUE,UAAV,qBACdgF,cAAchF,UADA,EACe,KAAKF,IAAL,CAAUE,UADzB,IAEnBgF,cAAchF,UAFlB;EAGA,WAAKF,IAAL,CAAUE,UAAV,CAAqB8B,IAArB,qBACKkD,cAAchF,UAAd,CAAyB8B,IAD9B,EAEK,KAAKhC,IAAL,CAAUE,UAAV,CAAqB8B,IAF1B;EAIA,WAAKhC,IAAL,CAAUE,UAAV,CAAqBC,MAArB,qBACK+E,cAAchF,UAAd,CAAyBC,MAD9B,EAEK,KAAKH,IAAL,CAAUE,UAAV,CAAqBC,MAF1B;EAIA,WAAKH,IAAL,CAAUE,UAAV,CAAqBqE,OAArB,qBACKW,cAAchF,UAAd,CAAyBqE,OAD9B,EAEK,KAAKvE,IAAL,CAAUE,UAAV,CAAqBqE,OAF1B,EAbkB;;EAoBlB,WAAKvE,IAAL,CAAUgC,IAAV,GAAiB,KAAKhC,IAAL,CAAUgC,IAAV,qBACRkD,cAAclD,IADN,EACe,KAAKhC,IAAL,CAAUgC,IADzB,IAEbkD,cAAclD,IAFlB;EAGA,WAAKhC,IAAL,CAAUgC,IAAV,CAAeoC,MAAf,qBAA6Bc,cAAclD,IAAd,CAAmBoC,MAAhD,EAA2D,KAAKpE,IAAL,CAAUgC,IAAV,CAAeoC,MAA1E;EACA,WAAKpE,IAAL,CAAUgC,IAAV,CAAeoC,MAAf,CAAsBlE,UAAtB,qBACK,KAAKF,IAAL,CAAUE,UAAV,CAAqBkE,MAD1B,EAEK,KAAKpE,IAAL,CAAUgC,IAAV,CAAeoC,MAAf,CAAsBlE,UAF3B,EAxBkB;;EA+BlB,WAAKF,IAAL,CAAUuE,OAAV,qBAAyBW,cAAcX,OAAvC,EAAmD,KAAKvE,IAAL,CAAUuE,OAA7D,EA/BkB;EAmClB;;EACA9H,aAAOC,OAAP,CAAe,KAAKsD,IAAL,CAAUG,MAAzB,EAAiCxD,OAAjC,CAAyC,iBAAiB;EAAA;EAAA,YAAfsE,IAAe;EAAA,YAATpE,GAAS;;EACxD,cAAKmD,IAAL,CAAUG,MAAV,CAAiBc,IAAjB,sBAA8BiE,cAAc/E,MAA5C,EAAuD,MAAKH,IAAL,CAAUG,MAAV,CAAiBc,IAAjB,CAAvD;EACA,cAAKjB,IAAL,CAAUG,MAAV,CAAiBc,IAAjB,EAAuBf,UAAvB,GAAoC,MAAKF,IAAL,CAAUG,MAAV,CAAiBc,IAAjB,EAAuBf,UAAvB,qBAC3B,MAAKF,IAAL,CAAUE,UAAV,CAAqBC,MADM,EACK,MAAKH,IAAL,CAAUG,MAAV,CAAiBc,IAAjB,EAAuBf,UAD5B,IAEhC,MAAKF,IAAL,CAAUE,UAAV,CAAqBC,MAFzB;EAGA,cAAKH,IAAL,CAAUG,MAAV,CAAiBc,IAAjB,EAAuBmD,MAAvB,qBAAqC,MAAKpE,IAAL,CAAUuE,OAA/C,EAA2D,MAAKvE,IAAL,CAAUG,MAAV,CAAiBc,IAAjB,EAAuBmD,MAAlF;EACA,cAAKpE,IAAL,CAAUG,MAAV,CAAiBc,IAAjB,EAAuBmD,MAAvB,CAA8BlE,UAA9B,qBACK,MAAKF,IAAL,CAAUE,UAAV,CAAqBqE,OAD1B,EAEK,MAAKvE,IAAL,CAAUG,MAAV,CAAiBc,IAAjB,EAAuBmD,MAAvB,CAA8BlE,UAFnC;EAID,OAVD;EAYA,WAAKF,IAAL,CAAUyE,MAAV,GAAmB,KAAKzE,IAAL,CAAUyE,MAAV,qBACVS,cAAcT,MADJ,EACe,KAAKzE,IAAL,CAAUyE,MADzB,IAEfS,cAAcT,MAFlB;EAIA,aAAO,IAAP;EACD;;;qCAEcvD,OAAO;EAAE;EACtB,UAAMtE,eAAcsE,KAAd,CAAN;;EADoB,UAEZD,IAFY,GAEHC,KAFG,CAEZD,IAFY;EAAA,UAGZlE,IAHY,GAGH,KAAKiF,IAHF,CAGZjF,IAHY;EAIpB,UAAIoI,SAAJ;;EAEA,UAAIvI,SAASoC,MAAb,EAAqB;EACnBmG,oBAAYlE,IAAZ;EACD;;EACD,UAAIrE,SAAS6C,MAAb,EAAqB;EACnB,YAAM2F,aAAa,KAAKhH,IAAL,CAAU8C,KAAV,CAAnB;;EAEA,YAAIkE,UAAJ,EAAgB;EACdD,sBAAYpI,KAAKsI,aAAL,CAAmBnE,KAAnB,EAA0BD,IAAtC;EACD,SAFD,MAEO;EACLkE,sBAAYjE,KAAZ;EACD;EACF;;EAED,aAAOiE,SAAP;EACD;;;mCAEYjE,OAAO;EAClB,aAAO,KAAKf,MAAL,CAAY,KAAKmF,cAAL,CAAoBpE,KAApB,CAAZ,EAAwC7D,KAA/C;EACD;;;oCAEa;EACZ,aAAO,KAAK2E,IAAL,CAAU3E,KAAjB;EACD;;;wCAEiB;EAChB,aAAO,KAAK2E,IAAL,CAAU3B,SAAjB;EACD;;;mCAEY;EACX,aAAO,KAAK2B,IAAL,CAAU1B,MAAjB;EACD;;;kCAEW;EACV,WAAK0B,IAAL,CAAUb,KAAV;EACD;;;iCAEUD,OAAO;EAAE;EAClB,WAAKf,MAAL,CAAY,KAAKmF,cAAL,CAAoBpE,KAApB,CAAZ,EAAwCC,KAAxC;EACD;;;+BAEQD,OAAO;EAAE;EAChB,aAAO,KAAKf,MAAL,CAAY,KAAKmF,cAAL,CAAoBpE,KAApB,CAAZ,EAAwCnE,IAA/C;EACD;;;+BAEQmE,cAAoB;EAAA,UAARlB,IAAQ;;EAC3B,UAAMnC,UAAUmC,IAAhB;EACAnC,cAAQuG,MAAR,GAAiBvG,QAAQuG,MAAR,GAAiBvG,QAAQuG,MAAzB,GAAkC,EAAnD;EACA,UAAMnD,OAAO,KAAKqE,cAAL,CAAoBpE,KAApB,CAAb;EAGA,UAAMqE,eAAe;EACnBrI,oBAAYW,QAAQX,UADD;EAEnBF,aAAKa,QAAQb,GAAR,IAAekI,cAAc/E,MAAd,CAAqBnD,GAFtB;EAGnBC,aAAKY,QAAQZ,GAAR,IAAeiI,cAAc/E,MAAd,CAAqBlD,GAHtB;EAInBuE,cAAM3D,QAAQ2D,IAAR,IAAgB0D,cAAc/E,MAAd,CAAqBqB,IAJxB;EAKnBtB,sCAAiB,KAAKF,IAAL,CAAUE,UAAV,CAAqBC,MAAtC,EAAiDtC,QAAQqC,UAAzD;EALmB,OAArB;EASA,UAAMsF,gBAAgB;EACpBvD,kBAAUpE,QAAQuG,MAAR,CAAenC,QAAf,IAA2BiD,cAAcX,OAAd,CAAsBtC,QADvC;EAEpBC,qBAAarE,QAAQuG,MAAR,CAAelC,WAAf,IAA8BgD,cAAcX,OAAd,CAAsBrC,WAF7C;EAGpB9E,iBAASS,QAAQuG,MAAR,CAAehH,OAAf,IAA0B8H,cAAcX,OAAd,CAAsBnH,OAHrC;EAIpB8C,sCAAiB,KAAKF,IAAL,CAAUE,UAAV,CAAqBqE,OAAtC,EAAkD1G,QAAQuG,MAAR,CAAelE,UAAjE;EAJoB,OAAtB;EAOA,WAAKuF,SAAL,CAAexE,IAAf,EAAqBsE,YAArB;EACA,WAAKG,UAAL,CAAgBzE,IAAhB,EAAsBuE,aAAtB;EAEA,aAAO,KAAKrF,MAAL,CAAYc,IAAZ,EAAkBlE,IAAzB;EACD;;;kCAEWmE,OAAO;EACjB,UAAMD,OAAO,KAAKqE,cAAL,CAAoBpE,KAApB,CAAb;EAEA,WAAKf,MAAL,CAAYc,IAAZ,EAAkBJ,MAAlB;EACA,WAAK0D,OAAL,CAAatD,IAAb,EAAmBJ,MAAnB;EACD;;;oCAEaK,OAAO;EAAE;EACrB,UAAMD,OAAO,KAAKqE,cAAL,CAAoBpE,KAApB,CAAb;;EAEA,UAAIA,MAAMhE,UAAV,EAAsB;EACpB,YAAMA,aAAaZ,UAAUqJ,QAAV,CAAmB,KAAKxF,MAAL,CAAYc,IAAZ,EAAkB2E,gBAArC,CAAnB;EACA,aAAKzF,MAAL,CAAYc,IAAZ,EAAkBZ,SAAlB,GAA8B,IAA9B;EACA,aAAKwF,aAAL,CAAmB5E,IAAnB,EAAyB/D,WAAWG,KAApC;EACD;;EAED,aAAO,KAAK8C,MAAL,CAAYc,IAAZ,EAAkBlE,IAAzB;EACD;;;qCAEc;EAAA;;EAAE;EACfN,aAAOC,OAAP,CAAe,KAAKyD,MAApB,EAA4BxD,OAA5B,CAAoC,iBAAmB;EAAA;EAAA,YAAjBsE,IAAiB;EAAA,YAAXC,KAAW;;EACrD,YAAIA,MAAMhE,UAAV,EAAsB;EACpB,cAAMA,aAAaZ,UAAUqJ,QAAV,CAAmBzE,MAAM0E,gBAAzB,CAAnB;EACA1E,gBAAM4E,iBAAN,CAAwB,IAAxB;;EACA,iBAAKD,aAAL,CAAmB5E,IAAnB,EAAyB/D,WAAWG,KAApC,EAA2CH,WAAWE,OAAtD;EACD;EACF,OAND;EAQA,WAAK4E,IAAL,CAAU3B,SAAV,GAAsB,IAAtB;EAEA,aAAO,KAAK2B,IAAL,CAAUjF,IAAjB;EACD;;;2CAEoB;EACnB,UAAMmG,OAAO,EAAb;EAEAzG,aAAOC,OAAP,CAAe,KAAKyD,MAApB,EAA4BxD,OAA5B,CAAoC,iBAAmB;EAAA;EAAA,YAAjBsE,IAAiB;EAAA,YAAXC,KAAW;;EACrD,YAAMtE,OAAOsE,MAAMnE,IAAN,CAAW0E,WAAX,CAAuBR,IAApC;;EAEA,YAAIrE,SAASiD,SAAb,EAAwB;EAAE;EACxBqD,eAAKjC,IAAL,IAAa,EAAb;EACAxD,gBAAMC,IAAN,CAAWwD,MAAMnE,IAAjB,EAAuBJ,OAAvB,CAA+B,UAACI,IAAD,EAAU;EACvC,gBAAIA,KAAKO,OAAT,EAAkB;EAChB4F,mBAAKjC,IAAL,EAAW8E,IAAX,CAAgBhJ,KAAKgB,KAArB;EACD;EACF,WAJD;EAKD,SAPD,MAOO,IAAInB,SAAS8B,mBAAb,EAAkC;EAAE;EACzCwE,eAAKjC,IAAL,IAAaC,MAAMnE,IAAN,CAAWc,OAAX,CAAmBqD,MAAMnE,IAAN,CAAWc,OAAX,CAAmBwF,aAAtC,EAAqDtF,KAAlE;EACD,SAFM,MAEA;EAAE;EACPmF,eAAKjC,IAAL,IAAaC,MAAMnE,IAAN,CAAWgB,KAAxB;EACD;EACF,OAfD;EAiBA,aAAOmF,IAAP;EACD;;;;;;MCvLkB8C;;;;;EACnB,6BAAyB;EAAA;;EAAA,QAARjB,IAAQ;;EAAA;;EACvB,uGAAWA,IAAX;;EADuB,uGAqFE,UAACkB,MAAD,EAAY;EACrC,UAAIA,WAAWnH,OAAf,EAAwB;EACtB,cAAKyF,OAAL,CAAavC,IAAb,CAAkB5E,OAAlB,GAA4B,MAAK4C,IAAL,CAAUgC,IAAV,CAAeoC,MAAf,CAAsBC,cAAlD;EACA,cAAKrC,IAAL,CAAUR,IAAV,GAAiB,IAAjB;;EACA,YAAI,MAAKxB,IAAL,CAAUyE,MAAV,CAAiBC,cAArB,EAAqC;EACnC,gBAAK1C,IAAL,CAAUb,KAAV;EACD;EACF;;EACD,UAAI8E,WAAWlH,KAAf,EAAsB;EACpB,cAAKwF,OAAL,CAAavC,IAAb,CAAkB5E,OAAlB,GAA4B,MAAK4C,IAAL,CAAUgC,IAAV,CAAeoC,MAAf,CAAsBE,YAAlD;EACA,cAAKtC,IAAL,CAAUR,IAAV,GAAiB,KAAjB;EACD;;EACD,YAAK+C,OAAL,CAAavC,IAAb,CAAkBkE,IAAlB;EACD,KAlGwB;;EAAA,2FAyIV,UAACzC,EAAD,EAAQ;EAAA,UACbxC,IADa,GACJwC,GAAGC,MADC,CACbzC,IADa;EAErB,UAAM/D,aAAaZ,UAAUqJ,QAAV,CAAmB,MAAKxF,MAAL,CAAYc,IAAZ,EAAkB2E,gBAArC,CAAnB;;EAEA,UAAI,MAAKzF,MAAL,CAAYc,IAAZ,EAAkB/D,UAAtB,EAAkC;EAChC,cAAK2I,aAAL,CAAmB5E,IAAnB,EAAyB/D,WAAWG,KAApC,EAA2CH,WAAWE,OAAtD;EACD;EACF,KAhJwB;;EAAA,4FAkJT,UAACqG,EAAD,EAAQ;EACtBA,SAAG0C,cAAH;EACA,UAAMC,aAAa,EAAnB,CAFsB;;EAKtB3J,aAAOC,OAAP,CAAe,MAAKyD,MAApB,EAA4BxD,OAA5B,CAAoC,iBAAmB;EAAA;EAAA,YAAjBsE,IAAiB;EAAA,YAAXC,KAAW;;EACrDA,cAAM4E,iBAAN,CAAwB,IAAxB;EACAM,mBAAWL,IAAX,CAAgB7E,MAAMnE,IAAtB;EACD,OAHD;;EAKA,YAAKkG,SAAL,CAAe4B,QAAf,CAAwB,MAAK7C,IAAL,CAAUjF,IAAlC,EAAwCqJ,UAAxC;;EAEA,YAAKC,YAAL;;EAEA,UAAI,MAAKrE,IAAL,CAAU3E,KAAd,EAAqB;EACnB,cAAKkH,OAAL,CAAavC,IAAb,CAAkBsE,IAAlB;;EAEA,YAAI,MAAKtG,IAAL,CAAUyE,MAAV,CAAiBjD,IAArB,EAA2B;EACzB,cAAM3D,UAAU;EACdjB,kBAAM,MAAKoD,IAAL,CAAUyE,MAAV,CAAiB7H,IADT;EAEdmG,iBAAK,MAAKf,IAAL,CAAUjF,IAAV,CAAewJ,MAFN;EAGdvD,oBAAQ,MAAKhB,IAAL,CAAUjF,IAAV,CAAeiG,MAHT;EAId7C,oBAAQ,MAAKA,MAJC;EAKd6B,kBAAM,MAAKA,IAAL,CAAUjF,IALF;EAMdkG,uBAAW;EACTY,4BAAc,MAAK2C,wBADV;EAET1C,sBAAQ,MAAKb,SAAL,CAAea;EAFd;EANG,WAAhB;EAWA,cAAMW,SAAS,IAAI3B,MAAJ,CAAWjF,OAAX,CAAf;EAEA4G,iBAAOgC,WAAP,CAAmBhC,OAAOiC,QAAP,EAAnB;EAEAC,qBAAW,YAAM;EACf,kBAAKpC,OAAL,CAAavC,IAAb,CAAkBsE,IAAlB;EACD,WAFD,EAEG,IAFH;EAGD;EACF,OAvBD,MAuBO;EACL,cAAK/B,OAAL,CAAavC,IAAb,CAAkBkE,IAAlB;;EACAS,mBAAW,YAAM;EACf,gBAAKpC,OAAL,CAAavC,IAAb,CAAkBsE,IAAlB;EACD,SAFD,EAEG,IAFH;EAGD;EACF,KA7LwB;;EAEvB,UAAKM,IAAL;;EAFuB;EAGxB;;;;6BAEM;EAAA;;EACL,WAAKC,iBAAL,GAAyBC,QAAzB;EAEArK,aAAOC,OAAP,CAAe,KAAKsD,IAAL,CAAUG,MAAzB,EAAiCxD,OAAjC,CAAyC,iBAAmB;EAAA;EAAA,YAAjBsE,IAAiB;EAAA,YAAXC,KAAW;;EAC1D7C,gBAAQC,GAAR,CAAY2C,IAAZ,EAAkBC,KAAlB;;EACA,eAAKuE,SAAL,CAAexE,IAAf,EAAqBC,KAArB;;EACA,YAAIA,MAAMhE,UAAV,EAAsB;EACpB,iBAAKwI,UAAL,CAAgBzE,IAAhB,EAAsBC,MAAMkD,MAA5B;EACD;EACF,OAND;EAQA,aAAO,IAAP;EACD;;;iCAEU;EACT,UAAMvG,UAAU;EACdsC,gBAAQ,KAAKA,MADC;EAEdD,oBAAY,KAAKF,IAAL,CAAUE,UAAV,CAAqB8B,IAFnB;EAGdjF,cAAMsF,SAASgD,aAAT,CAAuB,KAAKrF,IAAL,CAAUgC,IAAV,CAAeO,KAAtC,CAHQ;EAIdtC,gBAAQoC,SAASgD,aAAT,CAAuB,KAAKrF,IAAL,CAAUgC,IAAV,CAAe/B,MAAtC,CAJM;EAKdG,kBAAU,KAAK2G,aALD;EAMdxG,kBAAU,KAAK0C,SAAL,CAAe2B;EANX,OAAhB;EASA,WAAK5C,IAAL,GAAY,IAAIjC,IAAJ,CAASlC,OAAT,CAAZ;EACA,WAAK6H,UAAL,CAAgBzG,IAAhB,EAAsB,KAAKe,IAAL,CAAUgC,IAAV,CAAeoC,MAArC;EAEA,aAAO,IAAP;EACD;;;gCAESnD,MAAMC,OAAO;EACrB,UAAInE,OAAO,KAAKiF,IAAL,CAAUjF,IAAV,CAAesI,aAAf,iBAAsCpE,IAAtC,OAAX;EADqB,kBAEJlE,IAFI;EAAA,UAEbH,IAFa,SAEbA,IAFa;EAGrB,UAAMiB,UAAU;EACdd,kBADc;EAEdG,oBAAYgE,MAAMhE,UAFJ;EAGdF,aAAKkE,MAAMlE,GAHG;EAIdC,aAAKiE,MAAMjE,GAJG;EAKduE,cAAMN,MAAMM,IALE;EAMdtB,oBAAYgB,MAAMhB,UANJ;EAOdK,kBAAU,KAAK0C,SAAL,CAAe0B;EAPX,OAAhB;;EAUA,UAAI/H,SAAS+C,KAAT,IAAkB/C,SAAS8C,QAA/B,EAAyC;EACvC3C,eAAO,KAAKiF,IAAL,CAAUjF,IAAV,CAAeiK,gBAAf,iBAAyC/F,IAAzC,OAAP;EACApD,gBAAQd,IAAR,GAAeA,IAAf;EACA,aAAKoD,MAAL,CAAYc,IAAZ,IAAoB,IAAIW,KAAJ,CAAU/D,OAAV,CAApB;EACD,OAJD,MAIO,IAAIjB,SAASgD,MAAb,EAAqB;EAC1B,aAAKO,MAAL,CAAYc,IAAZ,IAAoB,IAAIY,MAAJ,CAAWhE,OAAX,CAApB;EACD,OAFM,MAEA,IAAIjB,SAASkD,KAAb,EAAoB;EACzB,aAAKK,MAAL,CAAYc,IAAZ,IAAoB,IAAIa,KAAJ,CAAUjE,OAAV,CAApB;EACD,OAFM,MAEA;EACL,aAAKsC,MAAL,CAAYc,IAAZ,IAAoB,IAAIU,KAAJ,CAAU9D,OAAV,CAApB;EACD;;EAED,WAAKsC,MAAL,CAAYc,IAAZ,EAAkBgG,EAAlB,CAAqBtI,KAArB,EAA4B,KAAKuI,YAAjC;EACA,aAAO,IAAP;EACD;;;iCAEUjG,MAAMmD,QAAQ;EACvB,UAAMhH,UAAU,KAAK+C,MAAL,CAAYc,IAAZ,IACZ3E,UAAUqJ,QAAV,CAAmB,KAAKxF,MAAL,CAAYc,IAAZ,EAAkB2E,gBAArC,EAAuDxI,OAD3C,GAEZ,KAFJ;EAGA,UAAM+E,SAASiC,OAAOlC,WAAP,GACX,KAAK/B,MAAL,CAAYc,IAAZ,EAAkBlE,IADP,GAEXsF,SAASgD,aAAT,CAAuBjB,OAAOnC,QAA9B,CAFJ;EAGA,UAAMpE,UAAU;EACdmE,cAAM,KAAKA,IAAL,CAAUjF,IADF;EAEdmD,oBAAYkE,OAAOlE,UAFL;EAGd+B,kBAAUmC,OAAOnC,QAHH;EAId7E,iBAASgH,OAAOhH,OAAP,IAAkBA,OAJb;EAKd8E,qBAAakC,OAAOlC,WALN;EAMdC;EANc,OAAhB;EASA,WAAKoC,OAAL,CAAatD,IAAb,IAAqB,IAAIc,MAAJ,CAAWlE,OAAX,CAArB;EAEA,aAAO,IAAP;EACD;;;gDAiByBsG,UAAUgD,UAAUlG,MAAM7D,SAAS;EAAA;;EAC3D;EACA,UAAI,QAAO+G,SAASD,IAAhB,MAAyBrF,SAA7B,EAAwC;EACtCsF,iBACGD,IADH,CACQ;EAAA,iBAAQhB,KAAKkE,IAAL,EAAR;EAAA,SADR,EAEGlD,IAFH,CAEQ,gBAAQ;EACZ,iBAAK2B,aAAL,CAAmB5E,IAAnB,EAAyB,CAAC,CAACmG,KAAKD,QAAL,CAA3B,EAA2C/J,OAA3C;EACD,SAJH;EAKD,OAND,MAMO;EACL+G,iBAAS3D,gBAAT,CAA0B5B,IAA1B,EAAgC,UAAC6E,EAAD,EAAQ;EACtC,iBAAKoC,aAAL,CAAmB5E,IAAnB,EAAyB,CAAC,CAACoG,KAAKC,KAAL,CAAW7D,GAAGC,MAAH,CAAUS,QAArB,EAA+BgD,QAA/B,CAA3B,EAAqE/J,OAArE;EACD,SAFD;EAGD;EACF;;;oCAEa6D,MAAM5D,OAA6C;EAAA,UAAtCD,OAAsC,uEAA5B,KAAKmH,OAAL,CAAatD,IAAb,EAAmB7D,OAAS;EAAA,UACvDiD,SADuD,GACzC,KAAKF,MAAL,CAAYc,IAAZ,CADyC,CACvDZ,SADuD;;EAI/D,UAAI,QAAOhD,KAAP,MAAiB2B,MAArB,EAA6B;EAC3B,aAAKuI,yBAAL,CAA+BlK,MAAM8G,QAArC,EAA+C9G,MAAM8J,QAArD,EAA+DlG,IAA/D,EAAqE7D,OAArE;EACD,OAFD,MAEO;EACL,aAAK+C,MAAL,CAAYc,IAAZ,EAAkB4E,aAAlB,CAAgCxI,KAAhC;EACD;;EAED,WAAKkH,OAAL,CAAatD,IAAb,EAAmB7D,OAAnB,GAA6B,KAAK4C,IAAL,CAAUG,MAAV,CAAiBc,IAAjB,EAAuB7D,OAAvB,IAAkCA,OAA/D;;EACA,UAAI,CAACC,KAAD,IAAUgD,SAAd,EAAyB;EACvB,aAAKkE,OAAL,CAAatD,IAAb,EAAmBiF,IAAnB;EACD,OAFD,MAEO;EACL,aAAK3B,OAAL,CAAatD,IAAb,EAAmBqF,IAAnB;EACD;;EAED,WAAKtE,IAAL,CAAU6B,YAAV;EAEA,aAAO,IAAP;EACD;;;;IAxIsCiB;;;;;;;;"}