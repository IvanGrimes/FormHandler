{"version":3,"file":"FormHandler.js.map","sources":["../../src/js/common/FormHandlerError.js","../../src/js/core/Validator.js","../../src/js/core/Form.js","../../src/js/common/constants.js","../../src/js/core/Field.js","../../src/js/core/Input.js","../../src/js/core/Radio.js","../../src/js/core/Select.js","../../src/js/core/Notice.js","../../src/js/core/Sender.js","../../src/js/common/defaultConfig.js","../../src/js/FormHandler.js"],"sourcesContent":["// export default function FormHandlerError(message) {\n//   this.name = `FormHandlerError`;\n//   this.message = message;\n// }\n\nexport default class FormHandlerError extends Error {\n  constructor(props) {\n    super(props);\n  }\n}\n","import FormHandlerError from '../common/FormHandlerError';\n\nexport default class Validator {\n  constructor(custom) {\n    this.custom = custom;\n\n    this.addCustomValidations();\n  }\n\n  addCustomValidations() {\n    Object.entries(this.custom).forEach(([type, obj]) => {\n      Validator.validations[type] = obj;\n    });\n    return this;\n  };\n\n  static validate({type, node, min, max}) {\n    let validation = Validator.validations[type];\n\n    if (!validation) {\n      throw new FormHandlerError(`No handler to validate type ${type}`);\n    }\n\n    return validation(node, min, max);\n  }\n\n  static getMessage({type, node, min, max}) {\n    return Validator.validations[type](node, min, max).message;\n  }\n\n  static validations = {\n    isCheckboxChecked(node, min, max) {\n      let valid = false,\n          message = 'Check any boxes',\n          checked = 0;\n\n      node.forEach(el => {\n        el.checked ? checked += 1 : null;\n      });\n\n      if (min && max) {\n        valid = !!(min && max && checked >= min && checked <= max);\n      }\n      if (min && !max) {\n        valid = checked >= min;\n      }\n      if (!min && max) {\n        valid = checked <= max;\n      }\n\n      return {\n        valid,\n        message,\n      };\n    },\n    isRadioChecked(node) {\n      let valid = Array.from(node).some(el => el.checked === true),\n          message = 'Please, press any button';\n\n      console.log('radio',valid);\n\n      return {\n        valid,\n        message,\n      };\n    },\n    isSelected(node) {\n      const valid = Array.from(node.options)\n                         .filter(el => el.value.length > 0)\n                         .some(el => el.selected === true),\n        message = 'Please, choose any option';\n      return {\n        valid,\n        message,\n      };\n    },\n    isName(node, min, max) {\n      const pattern = /^[A-Za-z]/;\n      let valid = pattern.test(node.value),\n          message = `Must contain any latin character`;\n\n      if (node.value.length === 0) {\n        valid = false;\n        if (min && !max) {\n          message = `Must contain at least ${min} latin character`;\n        }\n        if (!min && max) {\n          message = `Must contain at least one latin character and less than ${max + 1}`;\n        }\n        if (min && max) {\n          message = `Must contain between ${min} and ${max} latin characters`;\n        }\n      } else {\n        if (min && node.value.length < min) {\n          valid = false;\n          message = `Must contain at least ${min} latin characters`;\n        }\n        if (max && node.value.length > max) {\n          valid = false;\n          message = `Must contain less than ${max + 1} latin characters`;\n        }\n        if (min && node.value.length > min) {\n          valid = true;\n        }\n      }\n\n      return {\n        valid,\n        message,\n      };\n    },\n    isEmail(node) {\n      const pattern = /^(([^<>()\\[\\]\\.,;:\\s@\\\"]+(\\.[^<>()\\[\\]\\.,;:\\s@\\\"]+)*)|(\\\".+\\\"))@(([^<>()[\\]\\.,;:\\s@\\\"]+\\.)+[^<>()[\\]\\.,;:\\s@\\\"]{2,})$/i;\n      let valid = pattern.test(node.value),\n          message = `Must be a valid email address`;\n\n      return {\n        valid,\n        message,\n      };\n    },\n    isPhone(node, min, max) {\n      const pattern = /^[+]?[\\s./0-9]*[(]?[0-9]{1,4}[)]?[-\\s./0-9]*$/g;\n      let valid = pattern.test(node.value),\n          message = `Must contain a valid phone number`;\n\n      return {\n        valid,\n        message,\n      };\n    },\n    isNonEmpty(node, min, max) {\n      let valid = node.value.length > 0,\n          message = `Must be non empty`;\n\n      if (min && node.value.length < min && node.value.length !== 0) {\n        valid = false;\n      }\n      if (max && node.value.length > max && node.value.length !== 0) {\n        valid = false;\n      }\n\n      return {\n        valid,\n        message,\n      };\n    },\n  };\n}\n","export default class Form {\n  constructor({ ...opts }) {\n    this.node = opts.node;\n    this.submit = opts.submit;\n    this.classNames = opts.classNames;\n    this.fields = opts.fields;\n    this.listener = opts.listener;\n    this.valid = false;\n    this.sended = null;\n\n    this.submit.addEventListener('click', this.listener);\n  }\n\n  setFormState() {\n    let validness = new Set();\n\n    Object.entries(this.fields).forEach(([name, field]) => {\n      validness.add(field.valid);\n    });\n\n    this.valid = !validness.has(false);\n\n    if (this.valid) {\n      this.node.classList.remove(this.classNames.isNotValid);\n      this.node.classList.add(this.classNames.isValid);\n    } else {\n      this.node.classList.remove(this.classNames.isValid);\n      this.node.classList.add(this.classNames.isNotValid);\n    }\n  }\n\n  clear() {\n    Object.entries(this.fields).forEach(([name, field]) => {\n      field.clear();\n    });\n\n    this.valid = false;\n    this.node.classList.remove(this.classNames.isNotValid);\n    this.node.classList.remove(this.classNames.isValid);\n  }\n}\n","export const RADIO_NODE_LIST = 'RadioNodeList';\nexport const HTML_SELECT_ELEMENT = 'HTMLSelectElement';\nexport const HTML_INPUT_ELEMENT = 'HTMLInputElement';\nexport const HTML_TEXTAREA_ELEMENT = 'HTMLTextAreaElement';\nexport const INPUT = 'input';\n","import {\n  RADIO_NODE_LIST,\n} from '../common/constants';\n\nexport default class Field {\n  constructor({node, validation, min, max, send, classNames}) {\n    this.node = node;\n    this.name = this.node.constructor.name === RADIO_NODE_LIST ? this.node[0].name : this.node.name;\n    this.validation = validation;\n    this.send = send;\n    this.min = min;\n    this.max = max;\n    this.classNames = classNames;\n    this.valid = false;\n  }\n\n  get validatorOptions() {\n    return {\n      type: this.validation,\n      node: this.node,\n      min: this.min,\n      max: this.max,\n    };\n  };\n\n  on(type, listener) {\n    if (this.node.constructor.name === RADIO_NODE_LIST) {\n      this.node.forEach(el => el.addEventListener(type, listener));\n    } else {\n      this.node.addEventListener(type, listener);\n    }\n  }\n\n  off(type, listener) {\n    if (this.node.constructor.name === RADIO_NODE_LIST) {\n      this.node.forEach(el => el.removeEventListener(type, listener));\n    } else {\n      this.node.removeEventListener(type, listener);\n    }\n  }\n}\n","import Field from './Field';\n\nexport default class Input extends Field {\n  constructor({...opts}) {\n    super({...opts});\n  }\n\n  setFieldState(valid) {\n    this.valid = valid;\n    this.toggleClassNames();\n  }\n\n  toggleClassNames() {\n    if (this.valid) {\n      this.node.classList.remove(this.classNames.isNotValid);\n      this.node.classList.add(this.classNames.isValid);\n    } else {\n      this.node.classList.remove(this.classNames.isValid);\n      this.node.classList.add(this.classNames.isNotValid);\n    }\n  }\n\n  clear() {\n    this.node.value = \"\";\n    this.valid = false;\n    this.node.classList.remove(this.classNames.isNotValid);\n    this.node.classList.remove(this.classNames.isValid);\n  }\n}\n","import Field from './Field';\n\nexport default class Radio extends Field {\n  constructor({...opts}) {\n    super({...opts});\n  }\n\n  setFieldState(valid) {\n    this.valid = valid;\n    this.toggleClassNames();\n  }\n\n  toggleClassNames() {\n    if (this.valid) {\n      this.node.forEach(el => el.classList.remove(this.classNames.isNotValid));\n      this.node.forEach(el => el.classList.add(this.classNames.isValid));\n    } else {\n      this.node.forEach(el => el.classList.remove(this.classNames.isValid));\n      this.node.forEach(el => el.classList.add(this.classNames.isNotValid));\n    }\n  }\n\n  clear() {\n    this.valid = false;\n    this.node.forEach(el => el.classList.remove(this.classNames.isValid));\n    this.node.forEach(el => el.classList.remove(this.classNames.isNotValid));\n    this.node.forEach(el => el.checked = false);\n  }\n}\n","import Field from './Field';\n\nexport default class Select extends Field {\n  constructor({...opts}) {\n    super({...opts})\n  }\n\n  setFieldState(valid) {\n    this.valid = valid;\n    this.toggleClassNames();\n  }\n\n  toggleClassNames() {\n    if (this.valid) {\n      this.node.classList.remove(this.classNames.isNotValid);\n      this.node.classList.add(this.classNames.isValid);\n    } else {\n      this.node.classList.remove(this.classNames.isValid);\n      this.node.classList.add(this.classNames.isNotValid);\n    }\n  }\n\n  clear() {\n    this.valid = false;\n    this.node.classList.remove(this.classNames.isValid);\n    this.node.classList.remove(this.classNames.isNotValid);\n    Array.from(this.node.options).forEach(el => el.selected = false);\n  }\n}\n","export default class Notice {\n  constructor({form, message, classNames, attachTo, nextToField, parent}) {\n    this.form = form;\n    this.message = message;\n    this.classNames = classNames;\n    this.attachTo = attachTo;\n    this.nextToField = nextToField;\n    this.parent = parent;\n    this.node = null;\n    this.mount();\n  }\n\n  mount() {\n    this.node = document.createElement('div');\n    this.node.classList.add(this.classNames.block);\n    this.node.classList.add(this.classNames.hidden);\n\n    if (this.attachTo) {\n      this.parent.appendChild(this.node);\n    } else {\n      if (this.nextToField === 'before') { // TODO: Change option to a true/false, and it'll be stick notice next to the field\n        this.form.insertBefore(this.node, this.parent);\n      }\n      if (this.nextToField === 'after') {\n        this.form.insertBefore(this.node, this.parent.nextElementSibling);\n      }\n    }\n  };\n\n  show() {\n    this.node.classList.remove(this.classNames.hidden);\n    this.node.classList.add(this.classNames.visible);\n    this.node.innerText = this.message;\n  };\n\n  hide() {\n    this.node.classList.remove(this.classNames.visible);\n    this.node.classList.add(this.classNames.hidden);\n  }\n}\n","import {\n  HTML_INPUT_ELEMENT,\n  HTML_TEXTAREA_ELEMENT,\n  RADIO_NODE_LIST,\n  HTML_SELECT_ELEMENT,\n} from \"../common/constants\";\n\nexport default class Sender {\n  constructor({type, url, method, fields, form, callbackOnSend}) {\n    this.type = type;\n    this.url = url;\n    this.method = method;\n    this.fields = fields;\n    this.form = form;\n    this.callbackOnSend = callbackOnSend;\n    this.sendRequest(this.makeData());\n  }\n\n  makeData() {\n    const data = new FormData();\n\n    Object.entries(this.fields).forEach(([name, field]) => {\n      if (!field.send) return;\n      const type = field.node.constructor.name;\n\n      if (type === HTML_INPUT_ELEMENT ||\n          type === HTML_TEXTAREA_ELEMENT) {\n        data.append(field.name, field.node.value);\n      }\n      if (type === HTML_SELECT_ELEMENT) {\n        data.append(field.name, field.node.options[field.node.options.selectedIndex].value);\n      }\n      if (type === RADIO_NODE_LIST) {\n        Array.from(field.node).forEach(node => {\n          if (node.checked) {\n            data.append(field.name, node.value);\n          }\n        });\n      }\n    });\n\n    return data;\n  }\n\n  sendRequest(data) {\n    if (this.type === 'xhr') {\n      const xhr = new XMLHttpRequest();\n      xhr.open(this.method, this.url, true);\n      xhr.addEventListener('readystatechange', (ev) => {\n        if (ev.target.readyState === 4) {\n          if (ev.target.status !== 200) {\n            console.log(`Status: ${ev.target.status}, Text: ${ev.target.statusText}`);\n            this.callbackOnSend('error');\n          } else {\n            this.callbackOnSend('success');\n          }\n        }\n      });\n      xhr.send(data);\n    }\n\n    if (this.type === 'fetch') {\n      fetch(this.url, {\n        method: this.method,\n        body: data,\n      }).then(data => {\n        if (data.status !== 200) {\n          console.log(`Status: ${data.status}, Text: ${data.statusText}`);\n          this.callbackOnSend('error');\n        } else {\n          this.callbackOnSend('success');\n        }\n      });\n    }\n  }\n}\n","export default {\n  form: {\n    block: '.formhandler',\n    submit: '.formhandler__submit',\n    notice: {\n      attachTo: '.formhandler__notices',\n      message: 'please, fill the form',\n      successMessage: 'ok',\n      errorMessage: 'oops',\n      classNames: {\n        block: 'formhandler__notice-form',\n        hidden: 'formhandler__notice-form--hidden',\n        visible: 'formhandler__notice-form--visible',\n      },\n    },\n  },\n  fields: {\n    min: false,\n    max: false,\n    send: true,\n  },\n  notices: {\n    attachTo: '.formhandler__notices',\n    nextToField: false,\n    message: false,\n  },\n  classNames: {\n    notices: {\n      block: 'formhandler__notice',\n      hidden: 'formhandler__notice--hidden',\n      visible: 'formhandler__notice--visible',\n    },\n    form: {\n      isValid: 'formhandler--is-valid',\n      isNotValid: 'formhandler--is-not-valid',\n      disabledSubmitButton: 'formhandler__submit--disabled',\n    },\n    fields: {\n      isValid: 'formhandler__field--is-valid',\n      isNotValid: 'formhandler__field--is-not-valid',\n    },\n  },\n  sender: {\n    send: true,\n    type: 'xhr',\n  }\n}\n","import Validator from './core/Validator';\nimport Form from './core/Form';\nimport Input from './core/Input';\nimport Radio from './core/Radio';\nimport Select from './core/Select';\nimport Notice from './core/Notice';\nimport Sender from './core/Sender';\nimport defaultConfig from './common/defaultConfig';\nimport {\n  RADIO_NODE_LIST,\n  HTML_SELECT_ELEMENT,\n  HTML_INPUT_ELEMENT,\n  HTML_TEXTAREA_ELEMENT,\n  INPUT,\n} from './common/constants';\n\nexport default class FormHandler {\n  constructor({...args}) {\n    this.opts = args;\n    this.fields = {};\n    this.notices = {};\n    this.form = null;\n    this.validator = new Validator(this.opts.customValidations);\n    this.init();\n  }\n\n  init() {\n    this.complementOptions().makeForm();\n\n    Object.entries(this.opts.fields).forEach(([name, field]) => {\n      this.makeField(name, field).makeNotice(name, field.notice);\n    });\n\n    return this;\n  }\n\n  complementOptions() {\n    // Add lacks classNames and merge.\n    this.opts.classNames = this.opts.classNames ? {...defaultConfig.classNames, ...this.opts.classNames} : defaultConfig.classNames;\n    this.opts.classNames.form = {...defaultConfig.classNames.form, ...this.opts.classNames.form};\n    this.opts.classNames.fields = {...defaultConfig.classNames.fields, ...this.opts.classNames.fields};\n    this.opts.classNames.notices = {...defaultConfig.classNames.notices, ...this.opts.classNames.notices};\n    // Add lacks form options and merge.\n    this.opts.form = this.opts.form ? {...defaultConfig.form, ...this.opts.form} : defaultConfig.form;\n    this.opts.form.notice = {...defaultConfig.form.notice, ...this.opts.form.notice};\n    this.opts.form.notice.classNames = {...this.opts.classNames.notice, ...this.opts.form.notice.classNames};\n    // Add lacks notices options and merge\n    this.opts.notices = {...defaultConfig.notices, ...this.opts.notices};\n    // Add lacks fields options and merge\n    Object.entries(this.opts.fields).forEach(([name, obj]) => {\n      this.opts.fields[name] = {...defaultConfig.fields, ...this.opts.fields[name]};\n      this.opts.fields[name].classNames = this.opts.fields[name].classNames ? {...this.opts.classNames.fields, ...this.opts.fields[name].classNames} : this.opts.classNames.fields;\n      this.opts.fields[name].notice = {...this.opts.notices, ...this.opts.fields[name].notice};\n      this.opts.fields[name].notice.classNames = {...this.opts.classNames.notices, ...this.opts.fields[name].notice.classNames};\n    });\n    this.opts.sender = this.opts.sender ? {...defaultConfig.sender, ...this.opts.sender} : defaultConfig.sender;\n\n    return this;\n  } // TODO: Need a review\n\n  makeForm() {\n    const options = {\n      fields: this.fields,\n      classNames: this.opts.classNames.form,\n      node: document.querySelector(this.opts.form.block),\n      submit: document.querySelector(this.opts.form.submit),\n      listener: this.submitHandler,\n    };\n\n    this.form = new Form(options);\n\n    this.makeNotice('form', this.opts.form.notice);\n    return this;\n  }\n\n  makeField(name, field) {\n    const node = this.form.node[name],\n      type = node.constructor.name,\n      options = {\n        node: node,\n        validation: field.validation,\n        min: field.min,\n        max: field.max,\n        send: field.send,\n        classNames: field.classNames,\n      };\n\n    if (type === HTML_INPUT_ELEMENT ||\n      type === HTML_TEXTAREA_ELEMENT) {\n      this.fields[name] = new Input(options);\n    }\n\n    if (type === RADIO_NODE_LIST) {\n      this.fields[name] = new Radio(options);\n    }\n\n    if (type === HTML_SELECT_ELEMENT) {\n      this.fields[name] = new Select(options);\n    }\n\n    return this;\n  }\n\n  makeNotice(name, notice) { // TODO: Make beautiful\n    const options = {\n      form: this.form.node,\n      classNames: notice.classNames,\n      attachTo: notice.attachTo,\n      message: notice.message || Validator.getMessage(this.fields[name].validatorOptions),\n      nextToField: notice.nextToField,\n      parent: notice.nextToField ? this.fields[name].node : document.querySelector(notice.attachTo),\n    };\n\n    this.notices[name] = new Notice(options);\n    return this;\n  }\n\n  setFieldStateFromResponse(response, property, name, message) {\n    console.log(response)\n    if (typeof response.then !== 'undefined') {\n      response\n        .then(data => data.json())\n        .then(json => this.setFieldState(name, !!json[property], message));\n    } else {\n      response.addEventListener('load', (ev) => {\n        this.setFieldState(name, !!JSON.parse(ev.target.response)[property], message);\n      });\n    }\n  }\n\n  setFieldState(name, valid, message) {\n    console.log(name, valid);\n    if (typeof valid === 'object') {\n      this.setFieldStateFromResponse(valid.response, valid.property, name, message);\n    } else {\n      this.fields[name].setFieldState(valid);\n    }\n    this.notices[name].message = message;\n    if (valid) {\n      this.notices[name].hide();\n    } else {\n      this.notices[name].show();\n    }\n    this.form.setFormState();\n    return this;\n  }\n\n  inputHandler = ev => {\n    const name = ev.target.name,\n          validation = Validator.validate(this.fields[name].validatorOptions);\n\n    this.setFieldState(name, validation.valid, validation.message);\n  }\n\n  submitHandler = (ev) => {\n    ev.preventDefault();\n    Object.entries(this.fields).forEach(([name, field]) => {\n      const validation = Validator.validate(field.validatorOptions);\n\n      this.setFieldState(name, validation.valid, validation.message);\n      field.on(INPUT, this.inputHandler);\n    });\n\n    this.form.setFormState();\n\n    if (this.form.valid) {\n      this.notices.form.hide();\n\n      if (this.opts.sender.send) {\n        const options = {\n          type: this.opts.sender.type,\n          url: this.form.node.action,\n          method: this.form.node.method,\n          fields: this.fields,\n          form: this.form.node,\n          callbackOnSend: this.setFormStateFromResponse,\n        };\n\n        new Sender(options);\n\n        setTimeout(() => {\n          this.notices.form.hide();\n        }, 2000);\n      }\n    } else {\n      this.notices.form.show();\n      setTimeout(() => {\n        this.notices.form.hide();\n      }, 2000);\n    }\n  }\n\n  setFormStateFromResponse = (result) => {\n    if (result === 'success') {\n      this.notices.form.message = this.opts.form.notice.successMessage;\n      this.form.send = true;\n      this.form.clear();\n    }\n    if (result === 'error') {\n      this.notices.form.message = this.opts.form.notice.errorMessage;\n      this.form.send = false;\n    }\n    this.notices.form.show();\n  }\n}\n"],"names":["FormHandlerError","props","Error","Validator","custom","addCustomValidations","Object","entries","forEach","type","obj","validations","node","min","max","validation","message","isCheckboxChecked","valid","checked","el","isRadioChecked","Array","from","some","console","log","isSelected","options","filter","value","length","selected","isName","pattern","test","isEmail","isPhone","isNonEmpty","Form","opts","submit","classNames","fields","listener","sended","addEventListener","validness","Set","name","field","add","has","classList","remove","isNotValid","isValid","clear","RADIO_NODE_LIST","HTML_SELECT_ELEMENT","HTML_INPUT_ELEMENT","HTML_TEXTAREA_ELEMENT","INPUT","Field","send","constructor","removeEventListener","Input","toggleClassNames","Radio","Select","Notice","form","attachTo","nextToField","parent","mount","document","createElement","block","hidden","appendChild","insertBefore","nextElementSibling","visible","innerText","Sender","url","method","callbackOnSend","sendRequest","makeData","data","FormData","append","selectedIndex","xhr","XMLHttpRequest","open","ev","target","readyState","status","statusText","fetch","body","then","notice","successMessage","errorMessage","notices","disabledSubmitButton","sender","FormHandler","args","validate","validatorOptions","setFieldState","preventDefault","on","inputHandler","setFormState","hide","action","setFormStateFromResponse","setTimeout","show","result","validator","customValidations","init","complementOptions","makeForm","makeField","makeNotice","defaultConfig","querySelector","submitHandler","getMessage","response","property","json","JSON","parse","setFieldStateFromResponse"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;EAAA;EACA;EACA;EACA;MAEqBA;;;;;EACnB,4BAAYC,KAAZ,EAAmB;EAAA;;EAAA,yFACXA,KADW;EAElB;;;qBAH2CC;;MCHzBC;;;EACnB,qBAAYC,MAAZ,EAAoB;EAAA;;EAClB,SAAKA,MAAL,GAAcA,MAAd;EAEA,SAAKC,oBAAL;EACD;;;;6CAEsB;EACrBC,aAAOC,OAAP,CAAe,KAAKH,MAApB,EAA4BI,OAA5B,CAAoC,gBAAiB;EAAA;EAAA,YAAfC,IAAe;EAAA,YAATC,GAAS;;EACnDP,kBAAUQ,WAAV,CAAsBF,IAAtB,IAA8BC,GAA9B;EACD,OAFD;EAGA,aAAO,IAAP;EACD;;;sCAEuC;EAAA,UAAvBD,IAAuB,SAAvBA,IAAuB;EAAA,UAAjBG,IAAiB,SAAjBA,IAAiB;EAAA,UAAXC,GAAW,SAAXA,GAAW;EAAA,UAANC,GAAM,SAANA,GAAM;EACtC,UAAIC,aAAaZ,UAAUQ,WAAV,CAAsBF,IAAtB,CAAjB;;EAEA,UAAI,CAACM,UAAL,EAAiB;EACf,cAAM,IAAIf,gBAAJ,uCAAoDS,IAApD,EAAN;EACD;;EAED,aAAOM,WAAWH,IAAX,EAAiBC,GAAjB,EAAsBC,GAAtB,CAAP;EACD;;;wCAEyC;EAAA,UAAvBL,IAAuB,SAAvBA,IAAuB;EAAA,UAAjBG,IAAiB,SAAjBA,IAAiB;EAAA,UAAXC,GAAW,SAAXA,GAAW;EAAA,UAANC,GAAM,SAANA,GAAM;EACxC,aAAOX,UAAUQ,WAAV,CAAsBF,IAAtB,EAA4BG,IAA5B,EAAkCC,GAAlC,EAAuCC,GAAvC,EAA4CE,OAAnD;EACD;;;;;;kBA1BkBb,0BA4BE;EACnBc,mBADmB,6BACDL,IADC,EACKC,GADL,EACUC,GADV,EACe;EAChC,QAAII,QAAQ,KAAZ;EAAA,QACIF,UAAU,iBADd;EAAA,QAEIG,UAAU,CAFd;EAIAP,SAAKJ,OAAL,CAAa,cAAM;EACjBY,SAAGD,OAAH,GAAaA,WAAW,CAAxB,GAA4B,IAA5B;EACD,KAFD;;EAIA,QAAIN,OAAOC,GAAX,EAAgB;EACdI,cAAQ,CAAC,EAAEL,OAAOC,GAAP,IAAcK,WAAWN,GAAzB,IAAgCM,WAAWL,GAA7C,CAAT;EACD;;EACD,QAAID,OAAO,CAACC,GAAZ,EAAiB;EACfI,cAAQC,WAAWN,GAAnB;EACD;;EACD,QAAI,CAACA,GAAD,IAAQC,GAAZ,EAAiB;EACfI,cAAQC,WAAWL,GAAnB;EACD;;EAED,WAAO;EACLI,kBADK;EAELF;EAFK,KAAP;EAID,GAxBkB;EAyBnBK,gBAzBmB,0BAyBJT,IAzBI,EAyBE;EACnB,QAAIM,QAAQI,MAAMC,IAAN,CAAWX,IAAX,EAAiBY,IAAjB,CAAsB;EAAA,aAAMJ,GAAGD,OAAH,KAAe,IAArB;EAAA,KAAtB,CAAZ;EAAA,QACIH,UAAU,0BADd;EAGAS,YAAQC,GAAR,CAAY,OAAZ,EAAoBR,KAApB;EAEA,WAAO;EACLA,kBADK;EAELF;EAFK,KAAP;EAID,GAnCkB;EAoCnBW,YApCmB,sBAoCRf,IApCQ,EAoCF;EACf,QAAMM,QAAQI,MAAMC,IAAN,CAAWX,KAAKgB,OAAhB,EACMC,MADN,CACa;EAAA,aAAMT,GAAGU,KAAH,CAASC,MAAT,GAAkB,CAAxB;EAAA,KADb,EAEMP,IAFN,CAEW;EAAA,aAAMJ,GAAGY,QAAH,KAAgB,IAAtB;EAAA,KAFX,CAAd;EAAA,QAGEhB,UAAU,2BAHZ;EAIA,WAAO;EACLE,kBADK;EAELF;EAFK,KAAP;EAID,GA7CkB;EA8CnBiB,QA9CmB,kBA8CZrB,IA9CY,EA8CNC,GA9CM,EA8CDC,GA9CC,EA8CI;EACrB,QAAMoB,UAAU,WAAhB;EACA,QAAIhB,QAAQgB,QAAQC,IAAR,CAAavB,KAAKkB,KAAlB,CAAZ;EAAA,QACId,4CADJ;;EAGA,QAAIJ,KAAKkB,KAAL,CAAWC,MAAX,KAAsB,CAA1B,EAA6B;EAC3Bb,cAAQ,KAAR;;EACA,UAAIL,OAAO,CAACC,GAAZ,EAAiB;EACfE,kDAAmCH,GAAnC;EACD;;EACD,UAAI,CAACA,GAAD,IAAQC,GAAZ,EAAiB;EACfE,oFAAqEF,MAAM,CAA3E;EACD;;EACD,UAAID,OAAOC,GAAX,EAAgB;EACdE,iDAAkCH,GAAlC,kBAA6CC,GAA7C;EACD;EACF,KAXD,MAWO;EACL,UAAID,OAAOD,KAAKkB,KAAL,CAAWC,MAAX,GAAoBlB,GAA/B,EAAoC;EAClCK,gBAAQ,KAAR;EACAF,kDAAmCH,GAAnC;EACD;;EACD,UAAIC,OAAOF,KAAKkB,KAAL,CAAWC,MAAX,GAAoBjB,GAA/B,EAAoC;EAClCI,gBAAQ,KAAR;EACAF,mDAAoCF,MAAM,CAA1C;EACD;;EACD,UAAID,OAAOD,KAAKkB,KAAL,CAAWC,MAAX,GAAoBlB,GAA/B,EAAoC;EAClCK,gBAAQ,IAAR;EACD;EACF;;EAED,WAAO;EACLA,kBADK;EAELF;EAFK,KAAP;EAID,GAhFkB;EAiFnBoB,SAjFmB,mBAiFXxB,IAjFW,EAiFL;EACZ,QAAMsB,UAAU,wHAAhB;EACA,QAAIhB,QAAQgB,QAAQC,IAAR,CAAavB,KAAKkB,KAAlB,CAAZ;EAAA,QACId,yCADJ;EAGA,WAAO;EACLE,kBADK;EAELF;EAFK,KAAP;EAID,GA1FkB;EA2FnBqB,SA3FmB,mBA2FXzB,IA3FW,EA2FLC,GA3FK,EA2FAC,GA3FA,EA2FK;EACtB,QAAMoB,UAAU,gDAAhB;EACA,QAAIhB,QAAQgB,QAAQC,IAAR,CAAavB,KAAKkB,KAAlB,CAAZ;EAAA,QACId,6CADJ;EAGA,WAAO;EACLE,kBADK;EAELF;EAFK,KAAP;EAID,GApGkB;EAqGnBsB,YArGmB,sBAqGR1B,IArGQ,EAqGFC,GArGE,EAqGGC,GArGH,EAqGQ;EACzB,QAAII,QAAQN,KAAKkB,KAAL,CAAWC,MAAX,GAAoB,CAAhC;EAAA,QACIf,6BADJ;;EAGA,QAAIH,OAAOD,KAAKkB,KAAL,CAAWC,MAAX,GAAoBlB,GAA3B,IAAkCD,KAAKkB,KAAL,CAAWC,MAAX,KAAsB,CAA5D,EAA+D;EAC7Db,cAAQ,KAAR;EACD;;EACD,QAAIJ,OAAOF,KAAKkB,KAAL,CAAWC,MAAX,GAAoBjB,GAA3B,IAAkCF,KAAKkB,KAAL,CAAWC,MAAX,KAAsB,CAA5D,EAA+D;EAC7Db,cAAQ,KAAR;EACD;;EAED,WAAO;EACLA,kBADK;EAELF;EAFK,KAAP;EAID;EApHkB;;MC9BFuB;;;EACnB,sBAAyB;EAAA,QAARC,IAAQ;;EAAA;;EACvB,SAAK5B,IAAL,GAAY4B,KAAK5B,IAAjB;EACA,SAAK6B,MAAL,GAAcD,KAAKC,MAAnB;EACA,SAAKC,UAAL,GAAkBF,KAAKE,UAAvB;EACA,SAAKC,MAAL,GAAcH,KAAKG,MAAnB;EACA,SAAKC,QAAL,GAAgBJ,KAAKI,QAArB;EACA,SAAK1B,KAAL,GAAa,KAAb;EACA,SAAK2B,MAAL,GAAc,IAAd;EAEA,SAAKJ,MAAL,CAAYK,gBAAZ,CAA6B,OAA7B,EAAsC,KAAKF,QAA3C;EACD;;;;qCAEc;EACb,UAAIG,YAAY,IAAIC,GAAJ,EAAhB;EAEA1C,aAAOC,OAAP,CAAe,KAAKoC,MAApB,EAA4BnC,OAA5B,CAAoC,iBAAmB;EAAA;EAAA,YAAjByC,IAAiB;EAAA,YAAXC,KAAW;;EACrDH,kBAAUI,GAAV,CAAcD,MAAMhC,KAApB;EACD,OAFD;EAIA,WAAKA,KAAL,GAAa,CAAC6B,UAAUK,GAAV,CAAc,KAAd,CAAd;;EAEA,UAAI,KAAKlC,KAAT,EAAgB;EACd,aAAKN,IAAL,CAAUyC,SAAV,CAAoBC,MAApB,CAA2B,KAAKZ,UAAL,CAAgBa,UAA3C;EACA,aAAK3C,IAAL,CAAUyC,SAAV,CAAoBF,GAApB,CAAwB,KAAKT,UAAL,CAAgBc,OAAxC;EACD,OAHD,MAGO;EACL,aAAK5C,IAAL,CAAUyC,SAAV,CAAoBC,MAApB,CAA2B,KAAKZ,UAAL,CAAgBc,OAA3C;EACA,aAAK5C,IAAL,CAAUyC,SAAV,CAAoBF,GAApB,CAAwB,KAAKT,UAAL,CAAgBa,UAAxC;EACD;EACF;;;8BAEO;EACNjD,aAAOC,OAAP,CAAe,KAAKoC,MAApB,EAA4BnC,OAA5B,CAAoC,iBAAmB;EAAA;EAAA,YAAjByC,IAAiB;EAAA,YAAXC,KAAW;;EACrDA,cAAMO,KAAN;EACD,OAFD;EAIA,WAAKvC,KAAL,GAAa,KAAb;EACA,WAAKN,IAAL,CAAUyC,SAAV,CAAoBC,MAApB,CAA2B,KAAKZ,UAAL,CAAgBa,UAA3C;EACA,WAAK3C,IAAL,CAAUyC,SAAV,CAAoBC,MAApB,CAA2B,KAAKZ,UAAL,CAAgBc,OAA3C;EACD;;;;;;ECvCI,IAAME,kBAAkB,eAAxB;AACP,EAAO,IAAMC,sBAAsB,mBAA5B;AACP,EAAO,IAAMC,qBAAqB,kBAA3B;AACP,EAAO,IAAMC,wBAAwB,qBAA9B;AACP,EAAO,IAAMC,QAAQ,OAAd;;MCAcC;;;EACnB,uBAA4D;EAAA,QAA/CnD,IAA+C,QAA/CA,IAA+C;EAAA,QAAzCG,UAAyC,QAAzCA,UAAyC;EAAA,QAA7BF,GAA6B,QAA7BA,GAA6B;EAAA,QAAxBC,GAAwB,QAAxBA,GAAwB;EAAA,QAAnBkD,IAAmB,QAAnBA,IAAmB;EAAA,QAAbtB,UAAa,QAAbA,UAAa;;EAAA;;EAC1D,SAAK9B,IAAL,GAAYA,IAAZ;EACA,SAAKqC,IAAL,GAAY,KAAKrC,IAAL,CAAUqD,WAAV,CAAsBhB,IAAtB,KAA+BS,eAA/B,GAAiD,KAAK9C,IAAL,CAAU,CAAV,EAAaqC,IAA9D,GAAqE,KAAKrC,IAAL,CAAUqC,IAA3F;EACA,SAAKlC,UAAL,GAAkBA,UAAlB;EACA,SAAKiD,IAAL,GAAYA,IAAZ;EACA,SAAKnD,GAAL,GAAWA,GAAX;EACA,SAAKC,GAAL,GAAWA,GAAX;EACA,SAAK4B,UAAL,GAAkBA,UAAlB;EACA,SAAKxB,KAAL,GAAa,KAAb;EACD;;;;yBAWET,MAAMmC,UAAU;EACjB,UAAI,KAAKhC,IAAL,CAAUqD,WAAV,CAAsBhB,IAAtB,KAA+BS,eAAnC,EAAoD;EAClD,aAAK9C,IAAL,CAAUJ,OAAV,CAAkB;EAAA,iBAAMY,GAAG0B,gBAAH,CAAoBrC,IAApB,EAA0BmC,QAA1B,CAAN;EAAA,SAAlB;EACD,OAFD,MAEO;EACL,aAAKhC,IAAL,CAAUkC,gBAAV,CAA2BrC,IAA3B,EAAiCmC,QAAjC;EACD;EACF;;;0BAEGnC,MAAMmC,UAAU;EAClB,UAAI,KAAKhC,IAAL,CAAUqD,WAAV,CAAsBhB,IAAtB,KAA+BS,eAAnC,EAAoD;EAClD,aAAK9C,IAAL,CAAUJ,OAAV,CAAkB;EAAA,iBAAMY,GAAG8C,mBAAH,CAAuBzD,IAAvB,EAA6BmC,QAA7B,CAAN;EAAA,SAAlB;EACD,OAFD,MAEO;EACL,aAAKhC,IAAL,CAAUsD,mBAAV,CAA8BzD,IAA9B,EAAoCmC,QAApC;EACD;EACF;;;0BAvBsB;EACrB,aAAO;EACLnC,cAAM,KAAKM,UADN;EAELH,cAAM,KAAKA,IAFN;EAGLC,aAAK,KAAKA,GAHL;EAILC,aAAK,KAAKA;EAJL,OAAP;EAMD;;;;;;MCrBkBqD;;;;;EACnB,uBAAuB;EAAA,QAAP3B,IAAO;;EAAA;;EAAA,gGACXA,IADW;EAEtB;;;;oCAEatB,OAAO;EACnB,WAAKA,KAAL,GAAaA,KAAb;EACA,WAAKkD,gBAAL;EACD;;;yCAEkB;EACjB,UAAI,KAAKlD,KAAT,EAAgB;EACd,aAAKN,IAAL,CAAUyC,SAAV,CAAoBC,MAApB,CAA2B,KAAKZ,UAAL,CAAgBa,UAA3C;EACA,aAAK3C,IAAL,CAAUyC,SAAV,CAAoBF,GAApB,CAAwB,KAAKT,UAAL,CAAgBc,OAAxC;EACD,OAHD,MAGO;EACL,aAAK5C,IAAL,CAAUyC,SAAV,CAAoBC,MAApB,CAA2B,KAAKZ,UAAL,CAAgBc,OAA3C;EACA,aAAK5C,IAAL,CAAUyC,SAAV,CAAoBF,GAApB,CAAwB,KAAKT,UAAL,CAAgBa,UAAxC;EACD;EACF;;;8BAEO;EACN,WAAK3C,IAAL,CAAUkB,KAAV,GAAkB,EAAlB;EACA,WAAKZ,KAAL,GAAa,KAAb;EACA,WAAKN,IAAL,CAAUyC,SAAV,CAAoBC,MAApB,CAA2B,KAAKZ,UAAL,CAAgBa,UAA3C;EACA,WAAK3C,IAAL,CAAUyC,SAAV,CAAoBC,MAApB,CAA2B,KAAKZ,UAAL,CAAgBc,OAA3C;EACD;;;;IAzBgCO;;MCAdM;;;;;EACnB,uBAAuB;EAAA,QAAP7B,IAAO;;EAAA;;EAAA,gGACXA,IADW;EAEtB;;;;oCAEatB,OAAO;EACnB,WAAKA,KAAL,GAAaA,KAAb;EACA,WAAKkD,gBAAL;EACD;;;yCAEkB;EAAA;;EACjB,UAAI,KAAKlD,KAAT,EAAgB;EACd,aAAKN,IAAL,CAAUJ,OAAV,CAAkB;EAAA,iBAAMY,GAAGiC,SAAH,CAAaC,MAAb,CAAoB,MAAKZ,UAAL,CAAgBa,UAApC,CAAN;EAAA,SAAlB;EACA,aAAK3C,IAAL,CAAUJ,OAAV,CAAkB;EAAA,iBAAMY,GAAGiC,SAAH,CAAaF,GAAb,CAAiB,MAAKT,UAAL,CAAgBc,OAAjC,CAAN;EAAA,SAAlB;EACD,OAHD,MAGO;EACL,aAAK5C,IAAL,CAAUJ,OAAV,CAAkB;EAAA,iBAAMY,GAAGiC,SAAH,CAAaC,MAAb,CAAoB,MAAKZ,UAAL,CAAgBc,OAApC,CAAN;EAAA,SAAlB;EACA,aAAK5C,IAAL,CAAUJ,OAAV,CAAkB;EAAA,iBAAMY,GAAGiC,SAAH,CAAaF,GAAb,CAAiB,MAAKT,UAAL,CAAgBa,UAAjC,CAAN;EAAA,SAAlB;EACD;EACF;;;8BAEO;EAAA;;EACN,WAAKrC,KAAL,GAAa,KAAb;EACA,WAAKN,IAAL,CAAUJ,OAAV,CAAkB;EAAA,eAAMY,GAAGiC,SAAH,CAAaC,MAAb,CAAoB,OAAKZ,UAAL,CAAgBc,OAApC,CAAN;EAAA,OAAlB;EACA,WAAK5C,IAAL,CAAUJ,OAAV,CAAkB;EAAA,eAAMY,GAAGiC,SAAH,CAAaC,MAAb,CAAoB,OAAKZ,UAAL,CAAgBa,UAApC,CAAN;EAAA,OAAlB;EACA,WAAK3C,IAAL,CAAUJ,OAAV,CAAkB;EAAA,eAAMY,GAAGD,OAAH,GAAa,KAAnB;EAAA,OAAlB;EACD;;;;IAzBgC4C;;MCAdO;;;;;EACnB,wBAAuB;EAAA,QAAP9B,IAAO;;EAAA;;EAAA,iGACXA,IADW;EAEtB;;;;oCAEatB,OAAO;EACnB,WAAKA,KAAL,GAAaA,KAAb;EACA,WAAKkD,gBAAL;EACD;;;yCAEkB;EACjB,UAAI,KAAKlD,KAAT,EAAgB;EACd,aAAKN,IAAL,CAAUyC,SAAV,CAAoBC,MAApB,CAA2B,KAAKZ,UAAL,CAAgBa,UAA3C;EACA,aAAK3C,IAAL,CAAUyC,SAAV,CAAoBF,GAApB,CAAwB,KAAKT,UAAL,CAAgBc,OAAxC;EACD,OAHD,MAGO;EACL,aAAK5C,IAAL,CAAUyC,SAAV,CAAoBC,MAApB,CAA2B,KAAKZ,UAAL,CAAgBc,OAA3C;EACA,aAAK5C,IAAL,CAAUyC,SAAV,CAAoBF,GAApB,CAAwB,KAAKT,UAAL,CAAgBa,UAAxC;EACD;EACF;;;8BAEO;EACN,WAAKrC,KAAL,GAAa,KAAb;EACA,WAAKN,IAAL,CAAUyC,SAAV,CAAoBC,MAApB,CAA2B,KAAKZ,UAAL,CAAgBc,OAA3C;EACA,WAAK5C,IAAL,CAAUyC,SAAV,CAAoBC,MAApB,CAA2B,KAAKZ,UAAL,CAAgBa,UAA3C;EACAjC,YAAMC,IAAN,CAAW,KAAKX,IAAL,CAAUgB,OAArB,EAA8BpB,OAA9B,CAAsC;EAAA,eAAMY,GAAGY,QAAH,GAAc,KAApB;EAAA,OAAtC;EACD;;;;IAzBiC+B;;MCFfQ;;;EACnB,wBAAwE;EAAA,QAA3DC,IAA2D,QAA3DA,IAA2D;EAAA,QAArDxD,OAAqD,QAArDA,OAAqD;EAAA,QAA5C0B,UAA4C,QAA5CA,UAA4C;EAAA,QAAhC+B,QAAgC,QAAhCA,QAAgC;EAAA,QAAtBC,WAAsB,QAAtBA,WAAsB;EAAA,QAATC,MAAS,QAATA,MAAS;;EAAA;;EACtE,SAAKH,IAAL,GAAYA,IAAZ;EACA,SAAKxD,OAAL,GAAeA,OAAf;EACA,SAAK0B,UAAL,GAAkBA,UAAlB;EACA,SAAK+B,QAAL,GAAgBA,QAAhB;EACA,SAAKC,WAAL,GAAmBA,WAAnB;EACA,SAAKC,MAAL,GAAcA,MAAd;EACA,SAAK/D,IAAL,GAAY,IAAZ;EACA,SAAKgE,KAAL;EACD;;;;8BAEO;EACN,WAAKhE,IAAL,GAAYiE,SAASC,aAAT,CAAuB,KAAvB,CAAZ;EACA,WAAKlE,IAAL,CAAUyC,SAAV,CAAoBF,GAApB,CAAwB,KAAKT,UAAL,CAAgBqC,KAAxC;EACA,WAAKnE,IAAL,CAAUyC,SAAV,CAAoBF,GAApB,CAAwB,KAAKT,UAAL,CAAgBsC,MAAxC;;EAEA,UAAI,KAAKP,QAAT,EAAmB;EACjB,aAAKE,MAAL,CAAYM,WAAZ,CAAwB,KAAKrE,IAA7B;EACD,OAFD,MAEO;EACL,YAAI,KAAK8D,WAAL,KAAqB,QAAzB,EAAmC;EAAE;EACnC,eAAKF,IAAL,CAAUU,YAAV,CAAuB,KAAKtE,IAA5B,EAAkC,KAAK+D,MAAvC;EACD;;EACD,YAAI,KAAKD,WAAL,KAAqB,OAAzB,EAAkC;EAChC,eAAKF,IAAL,CAAUU,YAAV,CAAuB,KAAKtE,IAA5B,EAAkC,KAAK+D,MAAL,CAAYQ,kBAA9C;EACD;EACF;EACF;;;6BAEM;EACL,WAAKvE,IAAL,CAAUyC,SAAV,CAAoBC,MAApB,CAA2B,KAAKZ,UAAL,CAAgBsC,MAA3C;EACA,WAAKpE,IAAL,CAAUyC,SAAV,CAAoBF,GAApB,CAAwB,KAAKT,UAAL,CAAgB0C,OAAxC;EACA,WAAKxE,IAAL,CAAUyE,SAAV,GAAsB,KAAKrE,OAA3B;EACD;;;6BAEM;EACL,WAAKJ,IAAL,CAAUyC,SAAV,CAAoBC,MAApB,CAA2B,KAAKZ,UAAL,CAAgB0C,OAA3C;EACA,WAAKxE,IAAL,CAAUyC,SAAV,CAAoBF,GAApB,CAAwB,KAAKT,UAAL,CAAgBsC,MAAxC;EACD;;;;;;MC/BkBM;;;EACnB,wBAA+D;EAAA,QAAlD7E,IAAkD,QAAlDA,IAAkD;EAAA,QAA5C8E,GAA4C,QAA5CA,GAA4C;EAAA,QAAvCC,MAAuC,QAAvCA,MAAuC;EAAA,QAA/B7C,MAA+B,QAA/BA,MAA+B;EAAA,QAAvB6B,IAAuB,QAAvBA,IAAuB;EAAA,QAAjBiB,cAAiB,QAAjBA,cAAiB;;EAAA;;EAC7D,SAAKhF,IAAL,GAAYA,IAAZ;EACA,SAAK8E,GAAL,GAAWA,GAAX;EACA,SAAKC,MAAL,GAAcA,MAAd;EACA,SAAK7C,MAAL,GAAcA,MAAd;EACA,SAAK6B,IAAL,GAAYA,IAAZ;EACA,SAAKiB,cAAL,GAAsBA,cAAtB;EACA,SAAKC,WAAL,CAAiB,KAAKC,QAAL,EAAjB;EACD;;;;iCAEU;EACT,UAAMC,OAAO,IAAIC,QAAJ,EAAb;EAEAvF,aAAOC,OAAP,CAAe,KAAKoC,MAApB,EAA4BnC,OAA5B,CAAoC,iBAAmB;EAAA;EAAA,YAAjByC,IAAiB;EAAA,YAAXC,KAAW;;EACrD,YAAI,CAACA,MAAMc,IAAX,EAAiB;EACjB,YAAMvD,OAAOyC,MAAMtC,IAAN,CAAWqD,WAAX,CAAuBhB,IAApC;;EAEA,YAAIxC,SAASmD,kBAAT,IACAnD,SAASoD,qBADb,EACoC;EAClC+B,eAAKE,MAAL,CAAY5C,MAAMD,IAAlB,EAAwBC,MAAMtC,IAAN,CAAWkB,KAAnC;EACD;;EACD,YAAIrB,SAASkD,mBAAb,EAAkC;EAChCiC,eAAKE,MAAL,CAAY5C,MAAMD,IAAlB,EAAwBC,MAAMtC,IAAN,CAAWgB,OAAX,CAAmBsB,MAAMtC,IAAN,CAAWgB,OAAX,CAAmBmE,aAAtC,EAAqDjE,KAA7E;EACD;;EACD,YAAIrB,SAASiD,eAAb,EAA8B;EAC5BpC,gBAAMC,IAAN,CAAW2B,MAAMtC,IAAjB,EAAuBJ,OAAvB,CAA+B,gBAAQ;EACrC,gBAAII,KAAKO,OAAT,EAAkB;EAChByE,mBAAKE,MAAL,CAAY5C,MAAMD,IAAlB,EAAwBrC,KAAKkB,KAA7B;EACD;EACF,WAJD;EAKD;EACF,OAlBD;EAoBA,aAAO8D,IAAP;EACD;;;kCAEWA,MAAM;EAAA;;EAChB,UAAI,KAAKnF,IAAL,KAAc,KAAlB,EAAyB;EACvB,YAAMuF,MAAM,IAAIC,cAAJ,EAAZ;EACAD,YAAIE,IAAJ,CAAS,KAAKV,MAAd,EAAsB,KAAKD,GAA3B,EAAgC,IAAhC;EACAS,YAAIlD,gBAAJ,CAAqB,kBAArB,EAAyC,UAACqD,EAAD,EAAQ;EAC/C,cAAIA,GAAGC,MAAH,CAAUC,UAAV,KAAyB,CAA7B,EAAgC;EAC9B,gBAAIF,GAAGC,MAAH,CAAUE,MAAV,KAAqB,GAAzB,EAA8B;EAC5B7E,sBAAQC,GAAR,mBAAuByE,GAAGC,MAAH,CAAUE,MAAjC,qBAAkDH,GAAGC,MAAH,CAAUG,UAA5D;;EACA,oBAAKd,cAAL,CAAoB,OAApB;EACD,aAHD,MAGO;EACL,oBAAKA,cAAL,CAAoB,SAApB;EACD;EACF;EACF,SATD;EAUAO,YAAIhC,IAAJ,CAAS4B,IAAT;EACD;;EAED,UAAI,KAAKnF,IAAL,KAAc,OAAlB,EAA2B;EACzB+F,cAAM,KAAKjB,GAAX,EAAgB;EACdC,kBAAQ,KAAKA,MADC;EAEdiB,gBAAMb;EAFQ,SAAhB,EAGGc,IAHH,CAGQ,gBAAQ;EACd,cAAId,KAAKU,MAAL,KAAgB,GAApB,EAAyB;EACvB7E,oBAAQC,GAAR,mBAAuBkE,KAAKU,MAA5B,qBAA6CV,KAAKW,UAAlD;;EACA,kBAAKd,cAAL,CAAoB,OAApB;EACD,WAHD,MAGO;EACL,kBAAKA,cAAL,CAAoB,SAApB;EACD;EACF,SAVD;EAWD;EACF;;;;;;AC1EH,sBAAe;EACbjB,QAAM;EACJO,WAAO,cADH;EAEJtC,YAAQ,sBAFJ;EAGJkE,YAAQ;EACNlC,gBAAU,uBADJ;EAENzD,eAAS,uBAFH;EAGN4F,sBAAgB,IAHV;EAINC,oBAAc,MAJR;EAKNnE,kBAAY;EACVqC,eAAO,0BADG;EAEVC,gBAAQ,kCAFE;EAGVI,iBAAS;EAHC;EALN;EAHJ,GADO;EAgBbzC,UAAQ;EACN9B,SAAK,KADC;EAENC,SAAK,KAFC;EAGNkD,UAAM;EAHA,GAhBK;EAqBb8C,WAAS;EACPrC,cAAU,uBADH;EAEPC,iBAAa,KAFN;EAGP1D,aAAS;EAHF,GArBI;EA0Bb0B,cAAY;EACVoE,aAAS;EACP/B,aAAO,qBADA;EAEPC,cAAQ,6BAFD;EAGPI,eAAS;EAHF,KADC;EAMVZ,UAAM;EACJhB,eAAS,uBADL;EAEJD,kBAAY,2BAFR;EAGJwD,4BAAsB;EAHlB,KANI;EAWVpE,YAAQ;EACNa,eAAS,8BADH;EAEND,kBAAY;EAFN;EAXE,GA1BC;EA0CbyD,UAAQ;EACNhD,UAAM,IADA;EAENvD,UAAM;EAFA;EA1CK,CAAf;;MCgBqBwG;;;EACnB,6BAAuB;EAAA;;EAAA,QAAPC,IAAO;;EAAA;;EAAA,0CAkIR,cAAM;EACnB,UAAMjE,OAAOkD,GAAGC,MAAH,CAAUnD,IAAvB;EAAA,UACMlC,aAAaZ,UAAUgH,QAAV,CAAmB,MAAKxE,MAAL,CAAYM,IAAZ,EAAkBmE,gBAArC,CADnB;;EAGA,YAAKC,aAAL,CAAmBpE,IAAnB,EAAyBlC,WAAWG,KAApC,EAA2CH,WAAWC,OAAtD;EACD,KAvIsB;;EAAA,2CAyIP,UAACmF,EAAD,EAAQ;EACtBA,SAAGmB,cAAH;EACAhH,aAAOC,OAAP,CAAe,MAAKoC,MAApB,EAA4BnC,OAA5B,CAAoC,iBAAmB;EAAA;EAAA,YAAjByC,IAAiB;EAAA,YAAXC,KAAW;;EACrD,YAAMnC,aAAaZ,UAAUgH,QAAV,CAAmBjE,MAAMkE,gBAAzB,CAAnB;;EAEA,cAAKC,aAAL,CAAmBpE,IAAnB,EAAyBlC,WAAWG,KAApC,EAA2CH,WAAWC,OAAtD;;EACAkC,cAAMqE,EAAN,CAASzD,KAAT,EAAgB,MAAK0D,YAArB;EACD,OALD;;EAOA,YAAKhD,IAAL,CAAUiD,YAAV;;EAEA,UAAI,MAAKjD,IAAL,CAAUtD,KAAd,EAAqB;EACnB,cAAK4F,OAAL,CAAatC,IAAb,CAAkBkD,IAAlB;;EAEA,YAAI,MAAKlF,IAAL,CAAUwE,MAAV,CAAiBhD,IAArB,EAA2B;EACzB,cAAMpC,UAAU;EACdnB,kBAAM,MAAK+B,IAAL,CAAUwE,MAAV,CAAiBvG,IADT;EAEd8E,iBAAK,MAAKf,IAAL,CAAU5D,IAAV,CAAe+G,MAFN;EAGdnC,oBAAQ,MAAKhB,IAAL,CAAU5D,IAAV,CAAe4E,MAHT;EAId7C,oBAAQ,MAAKA,MAJC;EAKd6B,kBAAM,MAAKA,IAAL,CAAU5D,IALF;EAMd6E,4BAAgB,MAAKmC;EANP,WAAhB;EASA,cAAItC,MAAJ,CAAW1D,OAAX;EAEAiG,qBAAW,YAAM;EACf,kBAAKf,OAAL,CAAatC,IAAb,CAAkBkD,IAAlB;EACD,WAFD,EAEG,IAFH;EAGD;EACF,OAnBD,MAmBO;EACL,cAAKZ,OAAL,CAAatC,IAAb,CAAkBsD,IAAlB;;EACAD,mBAAW,YAAM;EACf,gBAAKf,OAAL,CAAatC,IAAb,CAAkBkD,IAAlB;EACD,SAFD,EAEG,IAFH;EAGD;EACF,KA7KsB;;EAAA,sDA+KI,UAACK,MAAD,EAAY;EACrC,UAAIA,WAAW,SAAf,EAA0B;EACxB,cAAKjB,OAAL,CAAatC,IAAb,CAAkBxD,OAAlB,GAA4B,MAAKwB,IAAL,CAAUgC,IAAV,CAAemC,MAAf,CAAsBC,cAAlD;EACA,cAAKpC,IAAL,CAAUR,IAAV,GAAiB,IAAjB;;EACA,cAAKQ,IAAL,CAAUf,KAAV;EACD;;EACD,UAAIsE,WAAW,OAAf,EAAwB;EACtB,cAAKjB,OAAL,CAAatC,IAAb,CAAkBxD,OAAlB,GAA4B,MAAKwB,IAAL,CAAUgC,IAAV,CAAemC,MAAf,CAAsBE,YAAlD;EACA,cAAKrC,IAAL,CAAUR,IAAV,GAAiB,KAAjB;EACD;;EACD,YAAK8C,OAAL,CAAatC,IAAb,CAAkBsD,IAAlB;EACD,KA1LsB;;EACrB,SAAKtF,IAAL,GAAY0E,IAAZ;EACA,SAAKvE,MAAL,GAAc,EAAd;EACA,SAAKmE,OAAL,GAAe,EAAf;EACA,SAAKtC,IAAL,GAAY,IAAZ;EACA,SAAKwD,SAAL,GAAiB,IAAI7H,SAAJ,CAAc,KAAKqC,IAAL,CAAUyF,iBAAxB,CAAjB;EACA,SAAKC,IAAL;EACD;;;;6BAEM;EAAA;;EACL,WAAKC,iBAAL,GAAyBC,QAAzB;EAEA9H,aAAOC,OAAP,CAAe,KAAKiC,IAAL,CAAUG,MAAzB,EAAiCnC,OAAjC,CAAyC,iBAAmB;EAAA;EAAA,YAAjByC,IAAiB;EAAA,YAAXC,KAAW;;EAC1D,eAAKmF,SAAL,CAAepF,IAAf,EAAqBC,KAArB,EAA4BoF,UAA5B,CAAuCrF,IAAvC,EAA6CC,MAAMyD,MAAnD;EACD,OAFD;EAIA,aAAO,IAAP;EACD;;;0CAEmB;EAAA;;EAClB;EACA,WAAKnE,IAAL,CAAUE,UAAV,GAAuB,KAAKF,IAAL,CAAUE,UAAV,qBAA2B6F,cAAc7F,UAAzC,EAAwD,KAAKF,IAAL,CAAUE,UAAlE,IAAgF6F,cAAc7F,UAArH;EACA,WAAKF,IAAL,CAAUE,UAAV,CAAqB8B,IAArB,qBAAgC+D,cAAc7F,UAAd,CAAyB8B,IAAzD,EAAkE,KAAKhC,IAAL,CAAUE,UAAV,CAAqB8B,IAAvF;EACA,WAAKhC,IAAL,CAAUE,UAAV,CAAqBC,MAArB,qBAAkC4F,cAAc7F,UAAd,CAAyBC,MAA3D,EAAsE,KAAKH,IAAL,CAAUE,UAAV,CAAqBC,MAA3F;EACA,WAAKH,IAAL,CAAUE,UAAV,CAAqBoE,OAArB,qBAAmCyB,cAAc7F,UAAd,CAAyBoE,OAA5D,EAAwE,KAAKtE,IAAL,CAAUE,UAAV,CAAqBoE,OAA7F,EALkB;;EAOlB,WAAKtE,IAAL,CAAUgC,IAAV,GAAiB,KAAKhC,IAAL,CAAUgC,IAAV,qBAAqB+D,cAAc/D,IAAnC,EAA4C,KAAKhC,IAAL,CAAUgC,IAAtD,IAA8D+D,cAAc/D,IAA7F;EACA,WAAKhC,IAAL,CAAUgC,IAAV,CAAemC,MAAf,qBAA4B4B,cAAc/D,IAAd,CAAmBmC,MAA/C,EAA0D,KAAKnE,IAAL,CAAUgC,IAAV,CAAemC,MAAzE;EACA,WAAKnE,IAAL,CAAUgC,IAAV,CAAemC,MAAf,CAAsBjE,UAAtB,qBAAuC,KAAKF,IAAL,CAAUE,UAAV,CAAqBiE,MAA5D,EAAuE,KAAKnE,IAAL,CAAUgC,IAAV,CAAemC,MAAf,CAAsBjE,UAA7F,EATkB;;EAWlB,WAAKF,IAAL,CAAUsE,OAAV,qBAAwByB,cAAczB,OAAtC,EAAkD,KAAKtE,IAAL,CAAUsE,OAA5D,EAXkB;;EAalBxG,aAAOC,OAAP,CAAe,KAAKiC,IAAL,CAAUG,MAAzB,EAAiCnC,OAAjC,CAAyC,iBAAiB;EAAA;EAAA,YAAfyC,IAAe;EAAA,YAATvC,GAAS;;EACxD,eAAK8B,IAAL,CAAUG,MAAV,CAAiBM,IAAjB,sBAA6BsF,cAAc5F,MAA3C,EAAsD,OAAKH,IAAL,CAAUG,MAAV,CAAiBM,IAAjB,CAAtD;EACA,eAAKT,IAAL,CAAUG,MAAV,CAAiBM,IAAjB,EAAuBP,UAAvB,GAAoC,OAAKF,IAAL,CAAUG,MAAV,CAAiBM,IAAjB,EAAuBP,UAAvB,qBAAwC,OAAKF,IAAL,CAAUE,UAAV,CAAqBC,MAA7D,EAAwE,OAAKH,IAAL,CAAUG,MAAV,CAAiBM,IAAjB,EAAuBP,UAA/F,IAA6G,OAAKF,IAAL,CAAUE,UAAV,CAAqBC,MAAtK;EACA,eAAKH,IAAL,CAAUG,MAAV,CAAiBM,IAAjB,EAAuB0D,MAAvB,qBAAoC,OAAKnE,IAAL,CAAUsE,OAA9C,EAA0D,OAAKtE,IAAL,CAAUG,MAAV,CAAiBM,IAAjB,EAAuB0D,MAAjF;EACA,eAAKnE,IAAL,CAAUG,MAAV,CAAiBM,IAAjB,EAAuB0D,MAAvB,CAA8BjE,UAA9B,qBAA+C,OAAKF,IAAL,CAAUE,UAAV,CAAqBoE,OAApE,EAAgF,OAAKtE,IAAL,CAAUG,MAAV,CAAiBM,IAAjB,EAAuB0D,MAAvB,CAA8BjE,UAA9G;EACD,OALD;EAMA,WAAKF,IAAL,CAAUwE,MAAV,GAAmB,KAAKxE,IAAL,CAAUwE,MAAV,qBAAuBuB,cAAcvB,MAArC,EAAgD,KAAKxE,IAAL,CAAUwE,MAA1D,IAAoEuB,cAAcvB,MAArG;EAEA,aAAO,IAAP;EACD;;;;iCAEU;EACT,UAAMpF,UAAU;EACde,gBAAQ,KAAKA,MADC;EAEdD,oBAAY,KAAKF,IAAL,CAAUE,UAAV,CAAqB8B,IAFnB;EAGd5D,cAAMiE,SAAS2D,aAAT,CAAuB,KAAKhG,IAAL,CAAUgC,IAAV,CAAeO,KAAtC,CAHQ;EAIdtC,gBAAQoC,SAAS2D,aAAT,CAAuB,KAAKhG,IAAL,CAAUgC,IAAV,CAAe/B,MAAtC,CAJM;EAKdG,kBAAU,KAAK6F;EALD,OAAhB;EAQA,WAAKjE,IAAL,GAAY,IAAIjC,IAAJ,CAASX,OAAT,CAAZ;EAEA,WAAK0G,UAAL,CAAgB,MAAhB,EAAwB,KAAK9F,IAAL,CAAUgC,IAAV,CAAemC,MAAvC;EACA,aAAO,IAAP;EACD;;;gCAES1D,MAAMC,OAAO;EACrB,UAAMtC,OAAO,KAAK4D,IAAL,CAAU5D,IAAV,CAAeqC,IAAf,CAAb;EAAA,UACExC,OAAOG,KAAKqD,WAAL,CAAiBhB,IAD1B;EAAA,UAEErB,UAAU;EACRhB,cAAMA,IADE;EAERG,oBAAYmC,MAAMnC,UAFV;EAGRF,aAAKqC,MAAMrC,GAHH;EAIRC,aAAKoC,MAAMpC,GAJH;EAKRkD,cAAMd,MAAMc,IALJ;EAMRtB,oBAAYQ,MAAMR;EANV,OAFZ;;EAWA,UAAIjC,SAASmD,kBAAT,IACFnD,SAASoD,qBADX,EACkC;EAChC,aAAKlB,MAAL,CAAYM,IAAZ,IAAoB,IAAIkB,KAAJ,CAAUvC,OAAV,CAApB;EACD;;EAED,UAAInB,SAASiD,eAAb,EAA8B;EAC5B,aAAKf,MAAL,CAAYM,IAAZ,IAAoB,IAAIoB,KAAJ,CAAUzC,OAAV,CAApB;EACD;;EAED,UAAInB,SAASkD,mBAAb,EAAkC;EAChC,aAAKhB,MAAL,CAAYM,IAAZ,IAAoB,IAAIqB,MAAJ,CAAW1C,OAAX,CAApB;EACD;;EAED,aAAO,IAAP;EACD;;;iCAEUqB,MAAM0D,QAAQ;EAAE;EACzB,UAAM/E,UAAU;EACd4C,cAAM,KAAKA,IAAL,CAAU5D,IADF;EAEd8B,oBAAYiE,OAAOjE,UAFL;EAGd+B,kBAAUkC,OAAOlC,QAHH;EAIdzD,iBAAS2F,OAAO3F,OAAP,IAAkBb,UAAUuI,UAAV,CAAqB,KAAK/F,MAAL,CAAYM,IAAZ,EAAkBmE,gBAAvC,CAJb;EAKd1C,qBAAaiC,OAAOjC,WALN;EAMdC,gBAAQgC,OAAOjC,WAAP,GAAqB,KAAK/B,MAAL,CAAYM,IAAZ,EAAkBrC,IAAvC,GAA8CiE,SAAS2D,aAAT,CAAuB7B,OAAOlC,QAA9B;EANxC,OAAhB;EASA,WAAKqC,OAAL,CAAa7D,IAAb,IAAqB,IAAIsB,MAAJ,CAAW3C,OAAX,CAArB;EACA,aAAO,IAAP;EACD;;;gDAEyB+G,UAAUC,UAAU3F,MAAMjC,SAAS;EAAA;;EAC3DS,cAAQC,GAAR,CAAYiH,QAAZ;;EACA,UAAI,OAAOA,SAASjC,IAAhB,KAAyB,WAA7B,EAA0C;EACxCiC,iBACGjC,IADH,CACQ;EAAA,iBAAQd,KAAKiD,IAAL,EAAR;EAAA,SADR,EAEGnC,IAFH,CAEQ;EAAA,iBAAQ,OAAKW,aAAL,CAAmBpE,IAAnB,EAAyB,CAAC,CAAC4F,KAAKD,QAAL,CAA3B,EAA2C5H,OAA3C,CAAR;EAAA,SAFR;EAGD,OAJD,MAIO;EACL2H,iBAAS7F,gBAAT,CAA0B,MAA1B,EAAkC,UAACqD,EAAD,EAAQ;EACxC,iBAAKkB,aAAL,CAAmBpE,IAAnB,EAAyB,CAAC,CAAC6F,KAAKC,KAAL,CAAW5C,GAAGC,MAAH,CAAUuC,QAArB,EAA+BC,QAA/B,CAA3B,EAAqE5H,OAArE;EACD,SAFD;EAGD;EACF;;;oCAEaiC,MAAM/B,OAAOF,SAAS;EAClCS,cAAQC,GAAR,CAAYuB,IAAZ,EAAkB/B,KAAlB;;EACA,UAAI,QAAOA,KAAP,MAAiB,QAArB,EAA+B;EAC7B,aAAK8H,yBAAL,CAA+B9H,MAAMyH,QAArC,EAA+CzH,MAAM0H,QAArD,EAA+D3F,IAA/D,EAAqEjC,OAArE;EACD,OAFD,MAEO;EACL,aAAK2B,MAAL,CAAYM,IAAZ,EAAkBoE,aAAlB,CAAgCnG,KAAhC;EACD;;EACD,WAAK4F,OAAL,CAAa7D,IAAb,EAAmBjC,OAAnB,GAA6BA,OAA7B;;EACA,UAAIE,KAAJ,EAAW;EACT,aAAK4F,OAAL,CAAa7D,IAAb,EAAmByE,IAAnB;EACD,OAFD,MAEO;EACL,aAAKZ,OAAL,CAAa7D,IAAb,EAAmB6E,IAAnB;EACD;;EACD,WAAKtD,IAAL,CAAUiD,YAAV;EACA,aAAO,IAAP;EACD;;;;;;;;;;;;"}